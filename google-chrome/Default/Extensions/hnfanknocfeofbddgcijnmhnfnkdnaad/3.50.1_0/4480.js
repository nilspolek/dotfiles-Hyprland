"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[4480],{868789:(e,n,t)=>{t.d(n,{n:()=>M});var i,a=t(202784),r=t(239398),s=t(783112),o=t(160593),c=t(61517),l=t(411088),d=t(960723),u=t(29904),g=t(661641),m=t(395545),I=t(446048),b=t(552322);e=t.hmd(e),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&i(e);var w,f,h="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},y=(0,r.defineMessages)({walletNoificationsText:{id:"/znRZQ",defaultMessage:[{type:0,value:"Wallet Notification Miami Image"}]}});function M(e){var n=e.title,t=e.description,i=e.retryAction,r=e.secondaryActionLabel,w=e.reconnectLabel,f=e.height,h=void 0===f?c.UV:f,M=e.onDismiss,S=i.onClick,p=i.label,x=(0,s.Z)().formatMessage,A=(0,a.useCallback)((function(){(0,o.logEvent)("send_resend_transaction",{action:m.ActionType.click,componentType:m.ComponentType.page,loggingId:"4f301266-e81e-4b25-929f-e074cc93e715"}),S()}),[S]);return(0,b.jsxs)(u.VStack,{height:h,spacingTop:1,children:[(0,b.jsx)(I.w,{onBack:M}),(0,b.jsxs)(u.VStack,{flexGrow:1,justifyContent:"space-between",spacing:2,children:[(0,b.jsxs)(u.VStack,{alignItems:"center",children:[(0,b.jsx)(l.H,{alt:x(y.walletNoificationsText),scaleMultiplier:.6}),(0,b.jsx)(g.TextTitle3,{testID:"phone-confirmation-title",as:"h1",align:"center",spacingBottom:2,spacingTop:3,children:n}),(0,b.jsx)(g.TextBody,{testID:"phone-confirmation-description",as:"p",color:"foregroundMuted",align:"center",children:t})]}),(0,b.jsxs)(u.VStack,{alignItems:"center",children:[(0,b.jsx)(g.TextBody,{testID:"phone-confirmation-secondary-label",as:"p",color:"foregroundMuted",spacingVertical:2,children:r}),(0,b.jsx)(d.Button,{block:!0,testID:"phone-confirmation-retry-button",variant:"secondary",onPress:A,children:p})]}),w?(0,b.jsx)(u.VStack,{alignItems:"center",spacingTop:2,children:(0,b.jsx)(g.TextLabel2,{testID:"phone-confirmation-reconnect-label",as:"p",align:"center",color:"foregroundMuted",children:w})}):null]})]})}h(M,"useIntl{{ formatMessage }}\nuseCallback{handleRetry}",(function(){return[s.Z]})),(w="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(w.register(y,"messages","/workspaces/libs/wallet-cds-extension/components/PhoneConfirmation.tsx"),w.register(M,"PhoneConfirmation","/workspaces/libs/wallet-cds-extension/components/PhoneConfirmation.tsx")),(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&f(e)},411088:(e,n,t)=>{t.d(n,{H:()=>l});const i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQwIiBoZWlnaHQ9IjI0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCAyNDBoMTQ0VjBIMHYyNDBaIiBmaWxsPSIjMDA1MkZGIi8+PHBhdGggZD0iTTcyIDE0YTIgMiAwIDEgMCAwLTQgMiAyIDAgMCAwIDAgNFpNODAgMjI2SDY0djRoMTZ2LTRaIiBmaWxsPSIjMEEwQjBEIi8+PHBhdGggZD0iTTAgMjE2aDE0NFYyNEgwdjE5MloiIGZpbGw9InVybCgjYSkiLz48cGF0aCBkPSJNMjAwIDgwdjgwSDQ4VjgwaDE1MloiIGZpbGw9InVybCgjYikiLz48cGF0aCBkPSJNMTQ0IDgwdjgwSDQ4VjgwaDk2WiIgZmlsbD0iIzAwNTJGRiIvPjxwYXRoIGQ9Ik0yMDAgMTI0Yy0yMi4wOTEgMC00MC0xNy45MDktNDAtNDBzMTcuOTA5LTQwIDQwLTQwIDQwIDE3LjkwOSA0MCA0MC0xNy45MDkgNDAtNDAgNDBaIiBmaWxsPSIjMDBEMTdGIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNjAgODRjMCAyMi4wOTEgMTcuOTA5IDQwIDQwIDQwVjgwaC0zOS44MDJhNDAuMzYyIDQwLjM2MiAwIDAgMC0uMTk4IDRaIiBmaWxsPSIjMDA1MkZGIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNzYgMTA1SDcydi0yaDEwNHYyWk0xNzYgMTIxSDcydi0yaDEwNHYyWk0xNzYgMTM3SDcydi0yaDEwNHYyWiIgZmlsbD0iIzBBMEIwRCIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9Ii0yNCIgeTE9IjI2MSIgeDI9IjE0NCIgeTI9IjI0IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIuMzgiIHN0b3AtY29sb3I9IiNGRkQyMDAiLz48c3RvcCBvZmZzZXQ9Ii43NzciIHN0b3AtY29sb3I9IiM1Q0UyRjgiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjEyNCIgeTE9IjgwIiB4Mj0iMTI0IiB5Mj0iMTYwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIuMjcyIiBzdG9wLWNvbG9yPSIjNUNFMkY4Ii8+PHN0b3Agb2Zmc2V0PSIuNzA0IiBzdG9wLWNvbG9yPSIjRUJDRUY4Ii8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PC9zdmc+";var a,r=t(386744),s=t(552322);e=t.hmd(e),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&a(e);var o,c;"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;function l(e){var n=e.alt,t=e.scaleMultiplier,a=void 0===t?1:t,o=a*r.TI.width,c=a*r.TI.height;return(0,s.jsx)("img",{src:i,alt:n,"data-testid":"wallet-notifications-miami",width:o,height:c})}(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&o.register(l,"WalletNotificationsMiami","/workspaces/libs/wallet-cds-web/components/MiamiIllustrationWrapper/MiamiIllustrations/WalletNotificationsMiami.tsx"),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)},902120:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.signAndSubmitViaWalletLink=void 0;const i=t(263678),a=t(697893),r=t(569952),s=t(223933),o=t(785669),c=t(859857),l=t(115818),d=t(937529),u=t(498855),g=t(447018),m=t(903172);async function I(e,n,t){let i;try{i=await e}catch(e){const n=e;if("string"==typeof n.message&&n.message.match(/(denied|rejected)/i))throw a.EthereumError.userRejectedWalletLinkRequest;throw n}const r="result"in i?i.result:void 0,s=i.method,o=r.startsWith("{")&&"generic"===s?JSON.parse(r):void 0,c=r.startsWith("{")||"generic"===s?void 0:r;if("generic"===s){if(o.gasPrice)return async function(e,n,t){const i=await d.Transaction.createSubmittedTx(e,n.txHash,void 0,t,"original");return i}(t,o,n);if(o.maxFeePerGas)return async function(e,n,t){const i=await d.Transaction.createSubmittedTx(e,n.txHash,void 0,t,"original"),{gasLimit:a,maxPriorityFeePerGas:r,maxFeePerGas:s,baseFeePerGas:o}=n,c=new l.PendingEthTxState(o,e.data,a,s,r,"original",e.l1GasFee);return{...i,pendingEthTxData:c}}(t,o,n)}return async function(e,n,t){if(!n)throw Error("A txHash must be passed");const i=await d.Transaction.createSubmittedTx(e,n,void 0,t,"original");return i}(t,c,n)}n.signAndSubmitViaWalletLink=function({unsignedTx:e,wallet:n,shouldUseGenericMessage:t,toUsername:a}){const l=e.network.asChain();if(!l)throw c.NetworkError.invalidNetwork(e.network);const d=(0,r.formatUsername)(a);if((0,o.isETHLegacyTx)(e)){const{cancel:a,signedTransaction:r}=function(e,n,t,a){const{currencyCode:r,erc20Value:s,data:o,fromAddress:c,gasLimit:l,gasPrice:d,toAddress:I,weiValue:b,recipientAddress:w}=e,f=0n===b&&(0n===s||void 0===s),h=(0,u.getWalletLinkRelay)(),{promise:y,cancel:M}=h.appVersion&&a&&!f?h.sendCbRequest({method:"generic",params:{action:"cbSignAndSubmit",data:{chainId:(0,i.ensureIntNumber)(Number(n.chainId)),currencyCode:r.code,data:(0,i.hexStringFromBuffer)(o,!0),erc20Value:s?(0,m.bigIntStringFromBigInt)(s):null,fromAddress:(0,i.ensureAddressString)(c),gasLimit:(0,m.bigIntStringFromBigInt)(l),gasPriceInWei:(0,m.bigIntStringFromBigInt)(d),maxFeePerGas:null,maxPriorityFeePerGas:null,nonce:null,recipientAddress:s?(0,i.ensureAddressString)(w):null,toAddress:(0,i.ensureAddressString)(I),toUsername:t,weiValue:(0,m.bigIntStringFromBigInt)(b)}}}):h.signAndSubmitEthereumTransaction({chainId:(0,i.ensureIntNumber)(Number(n.chainId)),data:o,fromAddress:(0,i.ensureAddressString)(c),gasLimit:(0,g.bnFromBigInt)(l),gasPriceInWei:(0,g.bnFromBigInt)(d),maxFeePerGas:null,maxPriorityFeePerGas:null,nonce:null,toAddress:(0,i.ensureAddressString)(I),weiValue:(0,g.bnFromBigInt)(b)});return{cancel:M,signedTransaction:y}}(e,l,d,t);return[I(r,n,e),a]}if((0,s.isETH1559Tx)(e)){const{cancel:a,signedTransaction:r}=function(e,n,t,a){const{fromAddress:r,toAddress:s,weiValue:o,data:c,gasLimit:l,erc20Value:d,currencyCode:I,maxFeePerGas:b,recipientAddress:w,maxPriorityFeePerGas:f}=e,h=0n===o&&(0n===d||void 0===d),y=(0,u.getWalletLinkRelay)(),{promise:M,cancel:S}=y.appVersion&&a&&!h?y.sendCbRequest({method:"generic",params:{action:"cbSignAndSubmit",data:{chainId:(0,i.ensureIntNumber)(Number(n.chainId)),currencyCode:I.code,data:(0,i.hexStringFromBuffer)(c,!0),erc20Value:d?(0,m.bigIntStringFromBigInt)(d):null,fromAddress:(0,i.ensureAddressString)(r),gasLimit:(0,m.bigIntStringFromBigInt)(l),gasPriceInWei:null,maxFeePerGas:(0,m.bigIntStringFromBigInt)(b),maxPriorityFeePerGas:(0,m.bigIntStringFromBigInt)(f),nonce:null,recipientAddress:d?(0,i.ensureAddressString)(w):null,toAddress:(0,i.ensureAddressString)(s),toUsername:t,weiValue:(0,m.bigIntStringFromBigInt)(o)}}}):y.signAndSubmitEthereumTransaction({chainId:(0,i.ensureIntNumber)(Number(n.chainId)),data:c,fromAddress:(0,i.ensureAddressString)(r),gasLimit:(0,g.bnFromBigInt)(l),gasPriceInWei:null,maxFeePerGas:(0,g.bnFromBigInt)(b),maxPriorityFeePerGas:(0,g.bnFromBigInt)(f),nonce:null,toAddress:(0,i.ensureAddressString)(s),weiValue:(0,g.bnFromBigInt)(o)});return{cancel:S,signedTransaction:M}}(e,l,d,t);return[I(r,n,e),a]}throw new Error("Unknown unsigned tx type")}},903172:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.bigIntStringFromBigInt=void 0,n.bigIntStringFromBigInt=function(e){return e.toString(10)}},569952:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.formatUsername=void 0,n.formatUsername=function(e){return e&&(e.startsWith("@")||e.includes("."))?e:null}},106940:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.signAndSubmitWalletlink=void 0;const i=t(108389),a=t(902120),r={[i.ETHEREUM_SYMBOL]:a.signAndSubmitViaWalletLink};n.signAndSubmitWalletlink=function({unsignedTx:e,wallet:n,shouldUseGenericMessage:t,toUsername:i}){return(0,r[n.blockchain.rawValue])({unsignedTx:e,wallet:n,shouldUseGenericMessage:t,toUsername:i})}},654717:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.useCallOnUnmountOrClose=void 0;const i=t(202784);n.useCallOnUnmountOrClose=function(e){(0,i.useEffect)((function(){const n=e;return n.current&&window.addEventListener("beforeunload",n.current),()=>{window.removeEventListener("beforeunload",n.current),n?.current()}}),[e])}},382969:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.useSignAndSubmitTransactionViaWalletLink=void 0;const i=t(202784),a=t(587952),r=t(617277),s=t(446101),o=t(106940),c=t(654717),l=t(924693),d=t(63504),u=t(410189),g=t(395545),m=t(251728);n.useSignAndSubmitTransactionViaWalletLink=function(){const e=(0,i.useRef)((()=>{})),n=(0,m.useSaveTransactions)(),t=(0,l.useShouldRefreshBalancesAfterTxSubmit)();return(0,c.useCallOnUnmountOrClose)(e),(0,i.useCallback)((async({unsignedTx:i,wallet:c,sessionIdHash:l,shouldUseGenericMessage:m=!1,toUsername:I})=>{e.current();const b=i.network.asChain()?.chainId??"",w=i.network.asChain()?.displayName??"",f={start:a.txSubmittedStart,success:a.txSubmittedSuccess,fail:a.txSubmittedFail,data:{loggingId:"4e3e5a90-5528-4287-b2fa-0d478b9716ab",action:g.ActionType.measurement,componentType:g.ComponentType.unknown,currencyCode:i.currencyCode.rawValue,blockchain:i.blockchain.rawValue,isContractDeploy:!i.recipientAddress,uuid:(0,u.v4)(),type:"walletlink",sessionIdHash:l??null,chainId:b,chainName:w,networkIsTestnet:i.network.isTestnet,txSource:(i.metadata.get(s.TxMetadataKey_txSource)??"").toLocaleString()},addSuccessDataToLog:({txHash:e})=>({txHash:e})};return(0,d.withEventLogging)((async()=>{const[a,s]=(0,o.signAndSubmitWalletlink)({unsignedTx:i,wallet:c,shouldUseGenericMessage:m,toUsername:I});return e.current=s,a.then((async a=>{n([i.asTransaction(a.txHash,a.nonce,c,i.metadata)]);return t(c.blockchain.rawValue,c.network.asChain())&&(0,r.refreshAddresses)({wallet:c}),e.current=()=>{},a}))}),f)}),[n,t])}}}]);
//# sourceMappingURL=4480.js.map