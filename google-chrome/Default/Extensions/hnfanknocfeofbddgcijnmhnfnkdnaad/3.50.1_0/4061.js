"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[4061],{209014:(e,t,n)=>{n.d(t,{P:()=>p});var r=n(601848),a=n(689103),i=n(552322);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e=n.hmd(e);var s,c,u,d=["analytics","chainDetails"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function p(e){var t,n=e.analytics,o=e.chainDetails,s=m(e,d);return(0,r.useTransactionDetailError)({eventName:null==n?void 0:n.eventName,eventProperties:null==n?void 0:n.eventProperties,message:null==s||null===(t=s.message)||void 0===t?void 0:t.toString(),chainDetails:o}),(0,i.jsx)(a.r,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({testID:"txn-detail-error"},s))}(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(p,"useTransactionDetailError{}",(function(){return[r.useTransactionDetailError]})),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&c.register(p,"TxDetailError","/workspaces/libs/wallet-cds-extension/components/TxDetails/TxDetailError.tsx"),(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&u(e)},689103:(e,t,n)=>{n.d(t,{r:()=>T});var r=n(202784),a=n(960723),i=n(586421),o=n(48972),s=n(661641),c=n(552322);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}e=n.hmd(e);var d,l,f,m=["isDismissible","showErrorIcon","message","learnMore","testID","showTextInRed"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function T(e){var t=e.isDismissible,n=e.showErrorIcon,u=e.message,d=e.learnMore,l=e.testID,f=e.showTextInRed,p=v(e,m),g=h((0,r.useState)(!0),2),y=g[0],T=g[1],S=(0,r.useCallback)((function(){T(!1)}),[]),w=(0,r.useCallback)((function(){chrome.tabs.create({url:null==d?void 0:d.url,active:!1})}),[d]),x=(0,r.useMemo)((function(){return(0,c.jsxs)(s.TextLabel2,{testID:l,as:"p",color:f?"negative":void 0,children:[u,d&&(0,c.jsxs)(c.Fragment,{children:["\xa0",(0,c.jsx)(s.Link,{variant:"label2",onClick:w,children:d.label})]})]})}),[d,l,f,u,w]);return y?(0,c.jsxs)(o.VStack,b(b({},p),{},{testID:"warning-banner",children:[(0,c.jsx)(o.Divider,{direction:"horizontal",width:"100%"}),(0,c.jsx)(o.HStack,{alignItems:"center",spacingVertical:.5,spacingHorizontal:3,children:(0,c.jsxs)(o.HStack,{alignItems:"center",spacingVertical:1,tabIndex:0,children:[n&&(0,c.jsx)(i.Icon,{name:"warning",size:"s",color:"negative",spacingEnd:2,testID:"warning-icon"}),x,t&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.Spacer,{}),(0,c.jsx)(a.IconButton,{testID:"close-icon-button",transparent:!0,name:"close",variant:"foregroundMuted",onPress:S})]})]})})]})):null}(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&d(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(T,"useState{[isErrorVisible, setIsErrorVisible](true)}\nuseCallback{onDismissError}\nuseCallback{onClickLearnMore}\nuseMemo{description}"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&l.register(T,"WarningBanner","/workspaces/libs/wallet-cds-extension/components/WarningBanner/WarningBanner.tsx"),(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&f(e)},555192:(e,t,n)=>{t.q=void 0;const r=n(202784),a=n(70801);t.q=function(){const e=(0,a.useHandleUnlockForTransaction)();return(0,r.useCallback)((function(t){return({unlockSuccess:n,unlockError:r})=>e({accountId:t,unlockSuccess:n,unlockError:r})}),[e])}},70801:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHandleUnlockForTransaction=void 0;const a=n(929148),i=r(n(334291)),o=n(870769),s=n(892254),c=n(427052);t.useHandleUnlockForTransaction=function(){const e=(0,a.useActiveAccountId)();return(0,s.useObservableCallback)(((t,{accountId:n,unlockSuccess:r,unlockError:a=i.default})=>{t&&t.unsubscribe();const s=n||e;return c.appLockRepository.unlock({...o.AppLockTypes.TransactionAccess,accountId:s}).subscribe((({status:e})=>{"SUCCESS"===e?r?.():a(new Error("Unlock Failed"))}),(e=>{a(e)}))}),[e])}},182955:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.form=t.initialValues=t.stepper=void 0;const r=n(108389),a=n(886855),i=n(230156),o=n(735103),s=n(601879);t.stepper=(0,o.createStepper)({steps:["entry","confirmationPreview","phoneConfirmation","selectAsset","selectWallet","selectNetwork","status","depositGas","loadingBestQuote","swapNux","gaslessSwapNux","adjustableSlippage","selectGasPaymentMethod"],defaultStep:"entry"}),t.initialValues={selectedNetwork:a.Network.fromChainId({chainPrefix:r.ETHEREUM_PREFIX,chainId:1n}),cryptoAmount:0n,enteredAmount:"",slippage:"30",isFiat:!0,assetId:"",targetAssetId:"",targetAssetContractAddress:"",sourceWalletId:"",swapTradeResponse:void 0,ledgerSwapError:void 0,unsignedApproveTxResult:void 0,unsignedSwapTxResult:void 0,unsignedSwapTxResults:void 0,signedApproveTx:void 0,signedSwapTx:void 0,nonce:void 0,formDepositAmount:void 0,shouldUpdateCryptoAmount:!1,mode:i.SwapMode.Normal,browserMode:!1,networkFeeInFiat:void 0,isGaslessToggleDisabled:!1,aggregatorID:"",transactionDetailError:void 0},t.form=(0,s.createForm)({initialValues:t.initialValues})},810435:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useSwapAnalyticsDetails=void 0;const r=n(202784),a=n(21717),i=n(601879),o=n(182955);t.useSwapAnalyticsDetails=function(){const{hasLocallyStoredKey:e}=(0,a.useActiveAccount)(),{selectedNetwork:{value:t},swapTradeResponse:{value:n},unsignedSwapTxResults:{value:s},mode:{value:c}}=(0,i.useFields)(o.form);return(0,r.useMemo)((()=>({isStandalone:e,network:t.rawValue,chainId:t.asChain()?.chainId??"",chainDisplayName:t.asChain()?.displayName??"",isLayer2:t.asChain()?.isLayer2??!1,isTestnet:t.asChain()?.isTestnet??!1,sourceCurrencyCode:n?.quote.fromAsset.currencyCode.rawValue??"",sourceAddress:n?.quote.fromAsset.address??"",targetAddress:n?.quote.toAsset.address??"",targetCurrencyCode:n?.quote.toAsset.currencyCode.rawValue??"",isMultiRouteSwap:Boolean(s&&s.length>1),hasCBOneSubscription:!1,swapMode:c})),[e,c,t,n?.quote.fromAsset.address,n?.quote.fromAsset.currencyCode.rawValue,n?.quote.toAsset.address,n?.quote.toAsset.currencyCode.rawValue,s])}},617277:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshAddresses=void 0;const r=n(152964),a=n(373881);t.refreshAddresses=function({wallet:e}){let t;switch(e.blockchain.rawValue){case"ETH":t=async()=>async function({wallet:e}){const t=a.Wallet.generateId(e);r.ethereumAddressHistoryListener.refreshAddresses({context:{walletId:t}})}({wallet:e});break;case"SOL":t=async()=>async function({wallet:e}){const t=a.Wallet.generateId(e);r.solanaAddressHistoryListener.refreshAddresses({context:{walletId:t}})}({wallet:e})}t&&(setTimeout(t,3e3),setTimeout(t,1e4))}},338032:function(e,t,n){var r=n(348834).Buffer,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encodeERC20Transfer=void 0;const i=a(n(538849)),o=n(447018),s=n(105181);t.encodeERC20Transfer=function(e,t,n){if(!s.Address.isValid(e))throw Error(`Invalid "toAddress" value passed. Given:${e}`);if(!s.Address.isValid(t))throw Error(`Invalid "contractAddress" value passed. Given:${t}`);return{toAddress:t,data:r.from(["a9059cbb",(0,i.default)((0,o.strip0x)(e),64,"0"),(0,i.default)(n.toString(16),64,"0")].join(""),"hex")}}},832901:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsignedERC201559Transaction=void 0;const r=n(503903),a=n(697893),i=n(306915),o=n(338032),s=n(333501),c=n(4871);t.generateUnsignedERC201559Transaction=async function({wallet:e,recipientAddress:t,transactionAmount:n,metadata:u,txConfiguration:d}){const{nonce:l}=d;if(!e.contractAddress)throw a.EthereumError.invalidERC20;const f="Amount"===n.kind?n.value:await(0,r.getERC20Balance)(e.primaryAddress,e.contractAddress,e.network),m=(0,o.encodeERC20Transfer)(t,e.contractAddress,f),p={...d,txType:"1559",dataBuffer:m.data},b=await(0,c.generateUnsigned1559Transaction)({wallet:e,recipientAddress:m.toAddress,metadata:u,transactionAmount:{kind:"Amount",value:0n},txConfiguration:p});if(!(b.transaction instanceof i.EthereumUnsigned1559Tx))throw a.EthereumError.unableToFindSignedTx;const g=b.transaction,[h,y,v]=await(0,s.fetchDomains)([g.fromAddress,e.contractAddress,t]),T=i.EthereumUnsigned1559Tx.createERC20Tx({fromAddress:g.fromAddress,fromDomain:h,walletIndex:g.walletIndex,contractAddress:e.contractAddress,contractDomain:y,recipientAddress:t,recipientDomain:v,nonce:l,erc20Value:f,data:g.data,maxFeePerGas:g.maxFeePerGas,maxPriorityFeePerGas:g.maxPriorityFeePerGas,gasLimit:g.gasLimit,network:g.network,currencyCode:g.currencyCode,feeCurrencyCode:g.feeCurrencyCode,feeCurrencyDecimal:g.feeCurrencyDecimal,blockchain:g.blockchain,metadata:u,baseFeePerGas:g.baseFeePerGas,l1GasFee:g.l1GasFee});return"Success"===b.kind?{kind:"Success",transaction:T,wallet:e,err:void 0}:{kind:"Failure",wallet:e,err:a.EthereumError.unableToEstimateGas}}},491982:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsignedLegacyERC20Transaction=void 0;const r=n(503903),a=n(697893),i=n(759301),o=n(338032),s=n(333501),c=n(581823);t.generateUnsignedLegacyERC20Transaction=async function({wallet:e,recipientAddress:t,transactionAmount:n,metadata:u,txConfiguration:d}){const{nonce:l}=d;if(!e.contractAddress)throw a.EthereumError.invalidERC20;const f="Amount"===n.kind?n.value:await(0,r.getERC20Balance)(e.primaryAddress,e.contractAddress,e.network),m=(0,o.encodeERC20Transfer)(t,e.contractAddress,f),p={...d,dataBuffer:m.data},b=await(0,c.generateUnsignedLegacyTransaction)({wallet:e,recipientAddress:m.toAddress,transactionAmount:{kind:"Amount",value:0n},metadata:u,txConfiguration:p});if(!(b.transaction instanceof i.EthereumUnsignedLegacyTx))throw a.EthereumError.unableToFindSignedTx;const g=b.transaction,[h,y,v]=await(0,s.fetchDomains)([g.fromAddress,e.contractAddress,t]),T=i.EthereumUnsignedLegacyTx.createERC20Tx({fromAddress:g.fromAddress,fromDomain:h,walletIndex:g.walletIndex,contractAddress:e.contractAddress,contractDomain:y,recipientAddress:t,recipientDomain:v,nonce:l,erc20Value:f,data:g.data,l1GasFee:g.l1GasFee,gasPrice:g.gasPrice,gasLimit:g.gasLimit,network:g.network,currencyCode:g.currencyCode,feeCurrencyCode:g.feeCurrencyCode,feeCurrencyDecimal:g.feeCurrencyDecimal,blockchain:g.blockchain,metadata:u});return"Success"===b.kind?{kind:"Success",transaction:T,wallet:e,err:void 0}:{kind:"Failure",wallet:e,err:a.EthereumError.unableToEstimateGas}}},171734:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsignedTransaction=void 0;const r=n(4871),a=n(832901),i=n(491982),o=n(581823);t.generateUnsignedTransaction=async function(e){const{wallet:t}=e;if("UTXO"===e.txConfiguration.txType)throw new Error("UTXO transaction not supported here");if(t.isBaseAsset&&e.txConfiguration){if("1559"===e.txConfiguration.txType)return(0,r.generateUnsigned1559Transaction)(e);if("Legacy"===e.txConfiguration.txType)return(0,o.generateUnsignedLegacyTransaction)(e)}if(e.txConfiguration){if("1559"===e.txConfiguration.txType)return(0,a.generateUnsignedERC201559Transaction)(e);if("Legacy"===e.txConfiguration.txType)return(0,i.generateUnsignedLegacyERC20Transaction)(e)}return e.txConfiguration}},866995:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmit=void 0;const r=n(502997),a=n(204785),i=n(223933),o=n(785669),s=n(86296),c=n(752897),u=n(293601),d=n(827039),l=n(697893);t.signAndSubmit=async function({unsignedTx:e,wallet:t,txSubmissionType:n,onSubmit:f,skipSubmit:m,isPrivatePoolEligible:p=!1}){let b;const g=new u.Tracer("sign_submit_ethereum");if((0,o.isETHLegacyTx)(e))g.startSpan("sign_transaction"),b=await(0,a.signAndSubmitTransaction)({tx:e,accountId:t.accountId,skipNonceCheck:void 0!==e.nonce,skipSubmit:m,isPrivatePoolEligible:p}),g.endSpan("sign_transaction");else{if(!(0,i.isETH1559Tx)(e))throw c.TransactionError.UnknownTransactionType;g.startSpan("sign1559_transaction"),b=await(0,r.signAndSubmit1559Transaction)({tx:e,accountId:t.accountId,skipNonceCheck:void 0!==e.nonce,skipSubmit:m,isPrivatePoolEligible:p}),g.endSpan("sign1559_transaction")}if(m)return g.done(),b;g.startSpan("insert_signed_transaction");const h=await(0,d.insertSignedTransaction)(b);if(g.endSpan("insert_signed_transaction"),!h)throw(0,s.cbReportError)({error:l.EthereumError.transactionSignatureMissing,context:"transactions",severity:"error",isHandled:!1}),l.EthereumError.transactionSignatureMissing;return g.startSpan("on_submit"),f(h),g.endSpan("on_submit"),g.done(),h}},502997:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmit1559Transaction=void 0;const r=n(103184),a=n(827039),i=n(211627),o=n(163785),s=n(859857),c=n(91427),u=n(410189),d=n(447018),l=n(446101),f=n(864074);t.signAndSubmit1559Transaction=async function({tx:e,accountId:t,skipNonceCheck:n=!1,skipSubmit:m=!1,isPrivatePoolEligible:p}){const b=e.network.asChain();if(!b)throw s.NetworkError.invalidNetwork(e.network);const g=await(0,r.getConfirmedEthereumTransactionCount)(e.fromAddress,e.network),h=await(0,a.getUnminedSignedTxsAfterNonce)(BigInt(g),BigInt(b.chainId),e.fromAddress),y=await(0,f.calculateNextNonce)(e,g,h,n),v=b.chainId,T=(0,o.getSigningOrDerivationMethodForAccount)(t,"signAndSubmitETH1559Transaction"),S=(0,l.ethereumAddressDerivationPath)(e.walletIndex),w=await T({accountId:t,derivationPath:S,skipSubmit:m,isPrivatePoolEligible:p,unsignedTx:{toAddress:e.toAddress,weiValue:(0,d.bnFromBigInt)(e.weiValue),data:e.data,nonce:Number(y),maxFeePerGas:(0,d.bnFromBigInt)(e.maxFeePerGas),maxPriorityFeePerGas:(0,d.bnFromBigInt)(e.maxPriorityFeePerGas),gasLimit:(0,d.bnFromBigInt)(e.gasLimit),chainId:v}});return new i.EthereumSignedTx((0,u.v4)(),e.fromAddress,e.toAddress,y,BigInt(v),w.data,(0,d.prepend0x)(w.hash.toString("hex")),e.weiValue,e.erc20Value,e.blockchain,e.currencyCode,c.TxState.PENDING,0n)}},204785:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmitTransaction=void 0;const r=n(103184),a=n(827039),i=n(327242),o=n(211627),s=n(163785),c=n(859857),u=n(91427),d=n(410189),l=n(447018),f=n(446101),m=n(864074);t.signAndSubmitTransaction=async function({tx:e,accountId:t,skipNonceCheck:n=!1,skipSubmit:p=!1,isPrivatePoolEligible:b}){const g=e.network.asChain();if(!g)throw c.NetworkError.invalidNetwork(e.network);const h=(0,f.ethereumAddressDerivationPath)(e.walletIndex),y=await(0,r.getConfirmedEthereumTransactionCount)(e.fromAddress,e.network),v=await(0,a.getUnminedSignedTxsAfterNonce)(y,BigInt(g.chainId),e.fromAddress);let T;const S=e.network.asChain();return T=S?.chainId===i.EthereumNetworkMap.whitelisted.LOCALHOST_8545.chainId?y:await(0,m.calculateNextNonce)(e,y,v,n),async function(e,t,n,r,a,i){const f=e.network.asChain();if(!f)throw c.NetworkError.invalidNetwork(e.network);let m;const p=[1,3,4,5,42,1337,31337].includes(f.chainId);if(p){const o=(0,s.getSigningOrDerivationMethodForAccount)(n,"signAndSubmitETH2930Transaction");m=await o({accountId:n,derivationPath:t,skipSubmit:a,isPrivatePoolEligible:i,unsignedTx:{toAddress:e.toAddress??null,weiValue:(0,l.bnFromBigInt)(e.weiValue),data:e.data,nonce:Number(r),gasPriceInWei:(0,l.bnFromBigInt)(e.gasPrice),gasLimit:(0,l.bnFromBigInt)(e.gasLimit),chainId:f.chainId}})}else{const o=(0,s.getSigningOrDerivationMethodForAccount)(n,"signAndSubmitETHLegacyTransaction");m=await o({accountId:n,derivationPath:t,skipSubmit:a,isPrivatePoolEligible:i,unsignedTx:{toAddress:e.toAddress??null,weiValue:(0,l.bnFromBigInt)(e.weiValue),data:e.data,nonce:Number(r),gasPriceInWei:(0,l.bnFromBigInt)(e.gasPrice),gasLimit:(0,l.bnFromBigInt)(e.gasLimit),chainId:f.chainId}})}return new o.EthereumSignedTx((0,d.v4)(),e.fromAddress,e.toAddress,r,BigInt(f.chainId),m.data,(0,l.prepend0x)(m.hash.toString("hex")),e.weiValue,e.erc20Value,e.blockchain,e.currencyCode,u.TxState.PENDING,0n)}(e,h,t,T,p,b)}},223933:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isETH1559Tx=void 0;const r=n(306915);t.isETH1559Tx=function(e){return e instanceof r.EthereumUnsigned1559Tx}},785669:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isETHLegacyTx=void 0;const r=n(759301);t.isETHLegacyTx=function(e){return e instanceof r.EthereumUnsignedLegacyTx}},6289:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmitTransaction=void 0;const r=n(143817),a=n(529225),i=n(86296),o=n(91427),s=n(410189),c=n(478210),u=n(389934),d=n(575561),l=n(463920),f=n(244530),m=n(306412),p=n(56111),b=n(145398);t.signAndSubmitTransaction=async function({unsignedTx:e,wallet:t,onSubmit:n,txSubmissionType:g,skipSubmit:h}){try{const i=e;let g,y;const v=i.submissionParams,T=await(0,r.getRecentBlockHash)(0);if(i.nativeDappTransaction){const{data:e,hash:n}=await(0,p.partialSignAndSubmitSolanaTransaction)(i.nativeDappTransaction,t.accountId,T,h??!1,v??{},t.selectedIndex);g=e,y=n}else if(t.contractAddress){const n=(0,m.buildSolanaSplSendTransaction)(t,e,T),{data:r,hash:a}=await(0,b.signAndSubmitSolanaTransaction)(n,t.accountId,h??!1,v??{},t.selectedIndex);g=r,y=a}else{const n=(0,f.buildSolanaSendTransaction)(t,e.recipientAddress,e.transferValue,T),{data:r,hash:a}=await(0,b.signAndSubmitSolanaTransaction)(n,t.accountId,h??!1,v??{},t.selectedIndex);g=r,y=a}if(h)return new l.SolanaSignedTx((0,s.v4)(),t.primaryAddress,e.recipientAddress,BigInt(e.network.asChain()?.chainId??d.SolanaNetworkMap.whitelisted.SOLANA_MAINNET.chainId),g,"",e.transferValue,e.blockchain,a.SolanaWalletConfiguration.currencyCode,o.TxState.PENDING,T,0n);if(y){const r=new l.SolanaSignedTx((0,s.v4)(),t.primaryAddress,e.recipientAddress,BigInt(e.network.asChain()?.chainId??d.SolanaNetworkMap.whitelisted.SOLANA_MAINNET.chainId),i.data,y,e.transferValue,e.blockchain,a.SolanaWalletConfiguration.currencyCode,o.TxState.PENDING,T,0n);return await(0,c.saveTransaction)(r),i.shouldSavePendingTransaction&&n(r),r}throw u.SolanaError.unableToSubmitTransaction}catch(e){throw(0,i.cbReportError)({error:e,context:"solana-error",severity:"error",isHandled:!1}),e}}},244530:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildSolanaSendTransaction=void 0;const r=n(935265);t.buildSolanaSendTransaction=function(e,t,n,a){const i=new r.Transaction,o=new r.PublicKey(e.primaryAddress);return i.feePayer=o,i.add(r.SystemProgram.transfer({fromPubkey:o,toPubkey:new r.PublicKey(t),lamports:Number(n)})),i.recentBlockhash=a,i}},306412:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildSolanaSplSendTransaction=void 0;const r=n(935265);t.buildSolanaSplSendTransaction=function(e,t,n){const a=new r.Transaction;if(a.feePayer=new r.PublicKey(e.primaryAddress),t.instructions)for(const e of t.instructions)a.add(e);return a.recentBlockhash=n,a}},56111:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.partialSignAndSubmitSolanaTransaction=void 0;const r=n(163785),a=n(529225);t.partialSignAndSubmitSolanaTransaction=async function(e,t,n,i,o,s){const c=e.signatures.some((e=>null!==e.signature));n&&!c&&(e.recentBlockhash=n);const u=(0,a.solanaAddressDerivationPath)(s||0n);return(0,r.getSigningOrDerivationMethodForAccount)(t,"partialSignAndSubmitSolanaTransaction")({accountId:t,derivationPath:u,solanaTx:e,skipSubmit:i,sendOptions:o})}},145398:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmitSolanaTransaction=void 0;const r=n(163785),a=n(529225);t.signAndSubmitSolanaTransaction=async function(e,t,n,i,o){const s=(0,a.solanaAddressDerivationPath)(o||0n);return(0,r.getSigningOrDerivationMethodForAccount)(t,"signAndSubmitSolanaTransaction")({accountId:t,derivationPath:s,solanaTx:e,skipSubmit:n,sendOptions:i})}},245323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.estimateFeeRate=void 0;const r=n(705452),a=n(218705),i=n(529829),o=10n;t.estimateFeeRate=async function(e,t){if(e.isTestnet)return o;const n=(await(0,i.estimateFee)({blockchainSymbol:t,testnet:!1}))[1];if(!n)throw r.UTXOError.unableToEstimateFee;return(0,a.BNToBigint)(n)}},199960:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsignedTransaction=void 0;const a=n(484475),i=n(539072),o=n(245323),s=n(381975),c=n(517394),u=n(637420),d=n(333501),l=n(214201),f=n(218705),m=r(n(35676)),p=n(754795),b=n(498379),g=n(529829),h=n(705452),y=n(9526);t.generateUnsignedTransaction=async function({wallet:e,transactionAmount:t,recipientAddress:n,metadata:r,txConfiguration:v}){const T=(0,c.ensureUTXOTxConfig)(v),S=T?.originalInputs,w=e.blockchain.rawValue;if(!(0,a.isUTXOBasedBlockchain)(w))throw new Error(`Invalid blockchain symbol ${w} for utxo configuration`);const x=a.blockchainConfigurations[w],O=await(0,u.getAddressesWithBalance)({blockchain:e.blockchain,currencyCode:e.currencyCode,network:e.network,accountId:e.accountId}),_=(0,s.getNextChangeAddress)({blockchain:e.blockchain,currencyCode:e.currencyCode,network:e.network,addressType:x.defaultReceiveType,accountId:e.accountId}),k=[];for(let t=0;t<O.length;t+=i.numUTXOsPerRequest){const n=O.slice(t,t+i.numUTXOsPerRequest).map((e=>e.address));k.push((0,b.getUTXOs)({blockchainSymbol:w,addresses:n,testnet:e.network.isTestnet}))}const[A,C,E]=await Promise.all([(0,o.estimateFeeRate)(e.network,w),Promise.all(k).then(m.default),_]),P=C.map((t=>({...t,addressType:(0,p.getAddressType)(w,t.address,e.network.isTestnet)}))),I=(await(0,l.retrievePendingTransactionsByChain)(x.blockchain.rawValue)).flatMap((e=>e.pendingUTXOTxData?.utxos??[])),M=P.filter((e=>I.some((t=>e.hash===t?.hash&&BigInt(e.index)===t?.index)))),B=P.filter((e=>S?.some((t=>e.hash===t?.hash&&BigInt(e.index)===t?.index)))),D=M.filter((e=>!B.some((t=>e.hash===t?.hash&&e.index===t?.index))));if(!E)throw h.UTXOError.changeAddressNotFound;const j=(0,f.bigIntToBN)(A);let N;if("original"===T.txSubmissionType||"speedUp"===T.txSubmissionType)switch(t.kind){case"EntireBalance":N=await(0,g.sweepCoins)({blockchainSymbol:w,utxos:P,toAddress:n,feeRate:j,isTestnet:e.network.isTestnet,excludeUTXOs:D,hardcodedTotalFee:T?.hardcodedTotalFee?(0,f.bigIntToBN)(T?.hardcodedTotalFee):void 0});break;case"Amount":N=(0,g.selectCoins)({blockchainSymbol:w,utxos:P,toAddress:n,changeAddress:E,amount:(0,f.bigIntToBN)(t.value),feeRate:j,testnet:e.network.isTestnet,includeUTXOs:B,excludeUTXOs:D,hardcodedTotalFee:T?.hardcodedTotalFee?(0,f.bigIntToBN)(T?.hardcodedTotalFee):void 0});break;default:throw new Error("Unhandled switch case, should never happen")}else{if("cancel"!==T.txSubmissionType)throw new Error("Unhandled txSubmissionType");N=await(0,g.sweepCoins)({blockchainSymbol:w,utxos:B,toAddress:E,feeRate:j,isTestnet:e.network.isTestnet,excludeUTXOs:D,hardcodedTotalFee:T?.hardcodedTotalFee?(0,f.bigIntToBN)(T?.hardcodedTotalFee):void 0})}const U=N.outputs.filter((e=>e.address!==E)).map((e=>(0,f.BNToBigint)(e.value))).reduce(((e,t)=>BigInt(e)+BigInt(t)),0n),[F,L]=await(0,d.fetchDomains)([e.primaryAddress,n]);return{kind:"Success",transaction:new y.UTXOUnsignedTx({blockchain:e.blockchain,coinSelection:N,fromAddress:e.primaryAddress,fromDomain:F,recipientAddress:n,recipientDomain:L,transferValue:U,currencyCode:e.currencyCode,network:e.network,estimatedFee:(0,f.BNToBigint)(N.fee),feeRate:(0,f.BNToBigint)(j),feeCurrencyCode:e.currencyCode,feeCurrencyDecimal:e.decimals,metadata:r,txSubmissionType:"original"}),wallet:e,err:void 0}}},381975:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNextChangeAddress=void 0;const r=n(637420);t.getNextChangeAddress=async function(e){const{blockchain:t,currencyCode:n,network:a,addressType:i,accountId:o}=e,s=await(0,r.getFirstUnusedAddress)({blockchain:t,currencyCode:n,addressType:i,isChangeAddress:!0,network:a,accountId:o});if(s)return s.address;const c=await(0,r.getLatestAddress)({blockchain:t,currencyCode:n,addressType:i,isChangeAddress:!0,network:a,accountId:o});return c?.address}},135536:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmitTransaction=void 0;const r=n(484475),a=n(163785),i=n(91427),o=n(752897),s=n(410189),c=n(605246),u=n(374014);t.signAndSubmitTransaction=async function({unsignedTx:e,wallet:t,onSubmit:n,txSubmissionType:d}){if(!e.coinSelection)throw o.TransactionError.UnknownTransactionType;const l=t.blockchain.rawValue;if(!(0,r.isUTXOBasedBlockchain)(l))throw new Error(`Invalid blockchain symbol ${l} for utxo configuration`);const{blockchain:f,currencyCode:m,network:p,coinSelection:b}=e,g=b.inputs.map((e=>e.address)),h=(0,a.getSigningOrDerivationMethodForAccount)(t.accountId,"signAndSubmitUTXOTransaction"),{data:y,hash:v}=await h({accountId:t.accountId,blockchain:f,currencyCode:m,addressesStr:g,network:p,wallet:t,coinSelection:b}),T=new u.UTXOSignedTx({id:(0,s.v4)(),signedTransactionData:y,txHash:v,state:i.TxState.PENDING,network:p,currencyCode:m,notFoundCount:0n,blockchain:f});return await(0,c.save)(T),n(T),T}},605246:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPendingTxs=t.save=void 0;const r=n(670279),a=n(91427),i=n(374014);function o(){return(0,r.tryGetRepository)("utxo_signed_tx")}t.save=async function(e){return await o().upsert(e.asDMO,["id"]),e},t.getPendingTxs=async function(e,t,n){return(await o().find({where:{state:a.TxState.PENDING.valueOf(),currencyCodeStr:t.rawValue,blockchainStr:e.rawValue,networkStr:n.rawValue}})).map(i.UTXOSignedTx.fromDMO)}},517394:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUTXOTxConfig=void 0,t.ensureUTXOTxConfig=function(e){return function(e){return"UTXO"===e?.txType&&["original","speedUp","cancel"].includes(e.txSubmissionType)}(e)?e:{txType:"UTXO",txSubmissionType:"original"}}},9526:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UTXOUnsignedTx=void 0;const r=n(115818),a=n(937529),i=n(736213),o=n(91427),s=n(410189);t.UTXOUnsignedTx=class{constructor(e){this.transferValue=e.transferValue,this.estimatedFee=e.estimatedFee,this.feeRate=e.feeRate,this.blockchain=e.blockchain,this.currencyCode=e.currencyCode,this.feeCurrencyCode=e.feeCurrencyCode,this.feeCurrencyDecimal=e.feeCurrencyDecimal,this.fromAddress=e.fromAddress,this.fromDomain=e.fromDomain,this.recipientAddress=e.recipientAddress,this.recipientDomain=e.recipientDomain,this.metadata=e.metadata,this.network=e.network,this.coinSelection=e.coinSelection,this.txSubmissionType=e.txSubmissionType}asTransaction(e,t,n,c){return new a.Transaction({id:(0,s.v4)(),createdAt:new Date,blockchain:this.blockchain,currencyCode:this.currencyCode,feeCurrencyCode:this.feeCurrencyCode,feeCurrencyDecimal:this.feeCurrencyDecimal,toAddress:this.recipientAddress,toDomain:this.recipientDomain,fromAddress:this.fromAddress,fromDomain:this.fromDomain,amount:this.transferValue,fee:this.estimatedFee,state:o.TxState.PENDING,metadata:new i.TxMetadata(c),network:this.network,txHash:e,isSent:!0,contractAddress:n.contractAddress,tokenName:n.displayName,tokenDecimal:n.decimals,walletId:n.id,nonce:t,pendingUTXOTxData:new r.PendingUTXOTxState(this.txSubmissionType,this.feeRate,this.coinSelection.inputs.map((e=>({hash:e.hash,index:BigInt(e.index)}))))})}}},924693:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useShouldRefreshBalancesAfterTxSubmit=void 0;const r=n(202784),a=n(214390),i=n(916589);t.useShouldRefreshBalancesAfterTxSubmit=function(){const e=(0,a.useOverridableKillSwitch)((0,i.getKillSwitchByPlatform)("kill_balance_nudge_blockchain_eth")),t=(0,a.useOverridableKillSwitch)((0,i.getKillSwitchByPlatform)("kill_balance_nudge_blockchain_sol"));return(0,r.useCallback)((function(n,r){switch(n){case"ETH":return e||!r?.isNudgeSupported;case"SOL":return t;default:return!1}}),[e,t])}},123132:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useSignAndSubmitStandalone=void 0;const r=n(202784),a=n(617277),i=n(86296),o=n(924693),s=n(547710),c=n(251728),u=n(518413);t.useSignAndSubmitStandalone=function({wallet:e,unsignedTx:t,unsignedApproveTx:n,signSuccess:d,signError:l,handleUnlock:f,unlockSuccess:m,unlockError:p,skipSubmit:b=!1,txSubmissionType:g="original",source:h="extension",onSubmit:y}){const[v,T]=(0,r.useState)(!1),S=(0,s.useIsPrivatePoolEligible)(),w=(0,c.useSaveTransactions)(),x=(0,o.useShouldRefreshBalancesAfterTxSubmit)(),O=(0,r.useCallback)((async function(n){t&&w([t.asTransaction(n.txHash,n.nonce,e,t.metadata,g)])}),[w,g,t,e]),_=(0,r.useCallback)((()=>{x(e.blockchain.rawValue,e.network.asChain())&&(0,a.refreshAddresses)({wallet:e})}),[e,x]),k=(0,r.useCallback)((function(e){y&&y(e),O(e),_()}),[y,O,_]),A=(0,r.useCallback)((async function(t){n&&w([n.asTransaction(t.txHash,t.nonce,e,n.metadata,g)])}),[w,g,n,e]),C=(0,r.useCallback)((async function(){try{if(n&&await(0,u.signAndSubmitTransaction)({unsignedTx:n,wallet:e,txSubmissionType:g,source:h,onSubmit:A}),!t)return null;const r=await(0,u.signAndSubmitTransaction)({unsignedTx:t,wallet:e,txSubmissionType:g,skipSubmit:b,onSubmit:k,source:h,isPrivatePoolEligible:S});d(r)}catch(e){(0,i.cbReportError)({error:e,context:"sign_and_submit_transaction_error",isHandled:!1,severity:"error"}),l(e)}finally{T(!1)}}),[n,t,e,g,b,k,h,S,d,A,l]),E=(0,r.useCallback)((function(){return T(!0),f({unlockSuccess:function(){m?.(),C()},unlockError:function(e){e&&p?.(e),T(!1)}})}),[f,C,p,m]);return(0,r.useMemo)((()=>({signAndSubmitStandalone:E,isSignAndSubmitStandaloneLoading:v})),[v,E])}},230156:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SwapMode=void 0,function(e){e.Normal="normal",e.Gasless="gasless"}(t.SwapMode||(t.SwapMode={}))},752897:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionError=void 0;class n extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}n.UnknownTransactionType=new n("UnknownTransactionType","Unknown transaction type"),n.UnableToHexEncode=new n("UnableToHexEncode","Unable to hex encode"),n.SponsoredSendError=new n("SponsoredSendError","Error attempting to send sponsored transaction"),n.GaslessSwapError=new n("GaslessSwapError","Error attempting to submit gasless swap transaction"),t.TransactionError=n},547710:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useIsPrivatePoolEligible=void 0;const r=n(202784),a=n(415363),i=n(214390),o=n(916589),s=n(633376);t.useIsPrivatePoolEligible=function(){const e=(0,i.useOverridableKillSwitch)((0,o.getKillSwitchByPlatform)("kill_private_pool")),t=(0,s.useIsExperimentInTreatment)(a.experiments.mar_2023_private_pool);return(0,r.useMemo)((()=>!e&&t),[e,t])}},251728:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useSaveTransactions=void 0;const r=n(202784),a=n(553476),i=n(214201),o=n(915577);t.useSaveTransactions=function(){const e=(0,a.useSetRecoilState)(o.transactionsAtom);return(0,r.useCallback)((function(t){e((e=>[...e,...t])),(0,i.persistTransactions)(t)}),[e])}},12059:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsignedTransaction=t.GenerateUnsignedTransactionByChain=void 0;const r=n(587952),a=n(446101),i=n(108389),o=n(171734),s=n(53610),c=n(171484),u=n(45378),d=n(199960),l=n(65341),f=n(494023),m=n(63504),p=n(410189),b=n(395545);t.GenerateUnsignedTransactionByChain={[s.SOLANA_SYMBOL]:c.generateUnsignedTransaction,[i.ETHEREUM_SYMBOL]:o.generateUnsignedTransaction,[u.BITCOIN_SYMBOL]:d.generateUnsignedTransaction,[l.DOGECOIN_SYMBOL]:d.generateUnsignedTransaction,[f.LITECOIN_SYMBOL]:d.generateUnsignedTransaction},t.generateUnsignedTransaction=async function({wallet:e,recipientAddress:n,transactionAmount:i,metadata:o,txConfiguration:s,isSponsoredTx:c=!1}){const u=e.network.asChain(),{chainId:d,displayName:l,isCustomNetwork:f,isTestnet:g}=u??{},h={start:r.txGenerationStart,success:r.txGenerationSuccess,fail:r.txGenerationFail,data:{loggingId:"317dbef1-e3c9-463c-b3a0-56505ae43c84",action:b.ActionType.measurement,componentType:b.ComponentType.unknown,isMax:"EntireBalance"===i.kind,uuid:(0,p.v4)(),currencyCode:e.currencyCode.rawValue,blockchain:e.blockchain.rawValue,chainId:d,chainName:l,isCustomNetwork:f,isTestnet:g,type:"legacy",txSource:(o.get(a.TxMetadataKey_txSource)??"").toLocaleString(),isSponsoredTx:c}},y=e.blockchain.rawValue,v=t.GenerateUnsignedTransactionByChain[y];return(0,m.withEventLogging)((async()=>v({wallet:e,recipientAddress:n,transactionAmount:i,metadata:o,txConfiguration:s})),h)}},518413:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSubmitTransaction=t.SignAndSubmitByChain=void 0;const r=n(587952),a=n(446101),i=n(108389),o=n(866995),s=n(529225),c=n(53610),u=n(6289),d=n(45378),l=n(135536),f=n(65341),m=n(494023),p=n(63504),b=n(410189),g=n(395545);t.SignAndSubmitByChain={[i.ETHEREUM_SYMBOL]:o.signAndSubmit,[c.SOLANA_SYMBOL]:u.signAndSubmitTransaction,[d.BITCOIN_SYMBOL]:l.signAndSubmitTransaction,[f.DOGECOIN_SYMBOL]:l.signAndSubmitTransaction,[m.LITECOIN_SYMBOL]:l.signAndSubmitTransaction},t.signAndSubmitTransaction=async function({unsignedTx:e,wallet:n,txSubmissionType:i,onSubmit:o,skipSubmit:c=!1,source:u="extension",isPrivatePoolEligible:d=!1}){const l={start:r.txSubmittedStart,success:r.txSubmittedSuccess,fail:r.txSubmittedFail,data:{loggingId:"ffb80dfe-60f4-4b71-be6b-a6c24dd785ce",action:g.ActionType.measurement,componentType:g.ComponentType.unknown,currencyCode:e.currencyCode.rawValue,chainName:e.network.asChain()?.displayName??"",chainId:e.network.asChain()?.chainId??"",isContractDeploy:!e.recipientAddress,blockchain:e.blockchain.rawValue,uuid:(0,b.v4)(),type:"extension",source:u,txSource:(e.metadata.get(a.TxMetadataKey_txSource)??"").toLocaleString(),...e.metadata.get(s.TxMetadataKey_solanaSwapStep)&&{solanaSwapStep:(e.metadata.get(s.TxMetadataKey_solanaSwapStep)??"")?.toLocaleString()}},addSuccessDataToLog:({txHash:e})=>({txHash:e})},f=n.blockchain.rawValue,m=t.SignAndSubmitByChain[f];return(0,p.withEventLogging)((async()=>m({unsignedTx:e,wallet:n,onSubmit:o,txSubmissionType:i,skipSubmit:c,isPrivatePoolEligible:d})),l)}},930830:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useTxFeeWallet=t.getFeeWallet=void 0;const r=n(202784),a=n(839668),i=n(524801),o=n(886855),s=n(158856);function c(e,{blockchain:t,feeCurrencyCode:n,network:r}){if(t&&n&&r)return e.find((e=>o.Network.isEqual(e.network,r)&&a.Blockchain.isEqual(e.blockchain,t)&&i.CurrencyCode.isEqual(e.currencyCode,n)&&e.isBaseAsset))}t.getFeeWallet=c,t.useTxFeeWallet=function(e,{blockchain:t,feeCurrencyCode:n,network:a}={}){const i=(0,s.useWalletsForWalletGroupId)(e);return(0,r.useMemo)((()=>{if(i)return c(i,{blockchain:t,feeCurrencyCode:n,network:a})}),[t,n,a,i])}},63504:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.withEventLogging=void 0;const r=n(160593),a=n(456792);t.withEventLogging=async function(e,{start:t,success:n,fail:i,data:o,addSuccessDataToLog:s}){(0,r.logDataEvent)(t,o);try{const t=await e(),a=s?.(t)??{};return(0,r.logDataEvent)(n,{...o,...a}),t}catch(e){throw(0,r.logDataEvent)(i,{...o,errorMessage:(0,a.getErrorMessage)(e)}),e}}},754795:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAddressType=void 0;const r=n(326071),a=n(97803),i=n(740692),o=n(533152);t.getAddressType=function(e,t,n){(0,r.validateAddress)({blockchainSymbol:e,address:t,testnet:n});const s=(0,a.getNetwork)(e,n);return(0,i.isBech32Address)(t,s)?"BECH32":(0,o.isP2SHAddress)(t,s)?"P2SH":"LEGACY"}},533152:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isP2SHAddress=void 0;const a=r(n(376314));t.isP2SHAddress=function(e,t){let n;try{n=a.default.address.fromBase58Check(e)}catch{return!1}return n.version===t.scriptHash}},848838:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoinSelectError=void 0;class n extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}n.unableToSelectCoins=new n("UnableToSelectCoins","Unable to select coins"),n.excludedUTXOsPrecludeCoinSelection=new n("excludedUTXOsPrecludeCoinSelection","pending transactions are preventing coin selection"),t.CoinSelectError=n},456147:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTxFeeRateForDOGE=void 0;const a=r(n(162197)),i=n(703818),o=new a.default(1e8),s=new a.default(1e3);t.calculateTxFeeRateForDOGE=function(e){const t=(0,i.bnDivCeil)(e,s);return(0,i.bnDivCeil)(o.mul(t),e)}},651674:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTxSizeForDOGE=void 0;const a=r(n(162197)),i=n(464904),o=n(435211);t.calculateTxSizeForDOGE=function(e,t,n,r=""){const s=new a.default(1);return n?(0,o.split)(e,t,s,r).fee:(0,i.coinselect)(e,t,s,[],r).fee}},453970:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.accumulative=void 0;const s=o(n(162197)),c=i(n(193979)),u=i(n(789068));t.accumulative=function(e,t,n,r,a){if(!u.uintOrNull(n))return{inputs:void 0,outputs:void 0,fee:new s.default(0)};let i=u.transactionBytes([],t),o=c.BN_ZERO;const d=[],l=u.sumOrZero(t);for(let s=0;s<e.length;++s){const f=e[s],m=u.inputBytes(f),p=u.uintOrNull(f.value);i=c.add(i,m),p&&(o=c.add(o,p)),d.push(f);const b=a||c.mul(n,i);if(!c.lt(o,c.add(l,b)))return u.finalize(d,t,n,r,a)}return{fee:a||c.mul(n,i)}}},145408:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.blackjack=void 0;const o=i(n(193979)),s=n(193979),c=i(n(789068));t.blackjack=function(e,t,n,r,a){if(!c.uintOrNull(n))return{fee:s.BN_ZERO};let i=c.transactionBytes([],t),u=o.BN_ZERO;const d=[],l=c.sumOrZero(t),f=c.dustThreshold(void 0,n);for(const s of e){const e=c.inputBytes(s),m=a||o.mul(n,o.add(i,e)),p=c.uintOrNull(s.value);if((!p||!o.gt(o.add(u,p),o.add(l,m,f)))&&(i=o.add(i,e),p&&(u=o.add(u,p)),d.push(s),!o.lt(u,o.add(l,m))))return c.finalize(d,t,n,r,a)}return{fee:a||o.mul(n,i)}}},193979:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gt=t.lt=t.eq=t.isZero=t.div=t.mul=t.sub=t.add=t.BN_ONE=t.BN_ZERO=void 0;const a=r(n(162197));function i(e,t){return e.add(t)}function o(e,t){return e.sub(t)}function s(e,t){return e.mul(t)}t.BN_ZERO=new a.default(0),t.BN_ONE=new a.default(1),t.add=function(...e){return e.reduce(i)},t.sub=function(...e){return e.reduce(o)},t.mul=function(...e){return e.reduce(s)},t.div=function(e,t){if(!t.isZero())return e.div(t)},t.isZero=function(e){return!!a.default.isBN(e)&&e.isZero()},t.eq=function(e,t){return!(!a.default.isBN(e)||!a.default.isBN(t))&&e.eq(t)},t.lt=function(e,t){return!(!a.default.isBN(e)||!a.default.isBN(t))&&e.lt(t)},t.gt=function(e,t){return!(!a.default.isBN(e)||!a.default.isBN(t))&&e.gt(t)}},464904:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.coinselect=void 0;const r=n(453970),a=n(145408),i=n(193979),o=n(789068);function s(e,t){return(0,i.sub)(e.value,(0,i.mul)(t,(0,o.inputBytes)(e)))}function c(e,t){return 0===e.length||t?.some((t=>e.some((e=>e.hash===t.hash&&e.index===t.index))))}t.coinselect=function(e,t,n,o,u,d){const l=e.sort(((e,t)=>{const r=o.some((t=>t.hash===e.hash&&t.index===e.index));return r===o.some((e=>e.hash===t.hash&&e.index===t.index))?(0,i.sub)(s(t,n),s(e,n)).toNumber():r?-1:1})),f=(0,a.blackjack)(l,t,n,u,d);if(f.inputs&&c(o,f.inputs))return f;const m=(0,r.accumulative)(l,t,n,u,d);return c(o,m.inputs)?m:{fee:m.fee}}},435211:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.split=void 0;const s=o(n(162197)),c=n(193979),u=i(n(789068));t.split=function(e,t,n,r,a){if(!u.uintOrNull(n))return{fee:(0,c.mul)(n,new s.default(0))};const i=u.transactionBytes(e,t),o=a||(0,c.mul)(n,i);if(0===t.length)return{fee:o};const d=u.sumOrZero(e),l=u.sumOrZero(t),f=(0,c.sub)(d,l,o);if(!f||f.isNeg())return{fee:o};const m=t.reduce(((e,t)=>e+(t.value?0:1)),0);if((0,c.isZero)(f)&&0===m)return u.finalize(e,t,n,r);const p=t.filter((e=>e.value===c.BN_ZERO)).length,b=(0,c.div)(f,new s.default(p));if(!t.every((e=>void 0!==e.value||(0,c.gt)(b??new s.default(0),u.dustThreshold(e,n)))))return{fee:o};const g=t.map((e=>e.value!==c.BN_ZERO?e:{...e,value:b}));return u.finalize(e,g,n,r)}},789068:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.finalize=t.sumOrZero=t.sumForgiving=t.uintOrNull=t.transactionBytes=t.dustThreshold=t.outputBytes=t.inputBytes=void 0;const a=r(n(162197)),i=n(88560),o=n(193979),s=new a.default(10),c={LEGACY:new a.default(148),P2SH:new a.default(92),BECH32:new a.default(69)},u={LEGACY:new a.default(34),P2SH:new a.default(32),BECH32:new a.default(31)};function d(e){return c[e?.addressType||"LEGACY"]}function l(e){return u[e?.type||"LEGACY"]}function f(e,t){return(0,o.mul)(d(void 0),t)}function m(e,t){const n=e.reduce(((e,t)=>(0,o.add)(e,d(t))),o.BN_ZERO),r=t.reduce(((e,t)=>(0,o.add)(e,l(t))),o.BN_ZERO);return(0,o.add)((0,o.add)(s,n),r)}function p(e){if(!e.isNeg())return e}function b(e){return e.reduce(((e,t)=>(0,o.add)(e,p(t.value??o.BN_ZERO)||o.BN_ZERO)),o.BN_ZERO)}t.inputBytes=d,t.outputBytes=l,t.dustThreshold=f,t.transactionBytes=m,t.uintOrNull=p,t.sumForgiving=function(e){return e.reduce(((e,t)=>(0,o.add)(e,t.value??o.BN_ZERO)),o.BN_ZERO)},t.sumOrZero=b;const g=l(void 0);t.finalize=function(e,t,n,r,a){const s=m(e,t),c=a||(0,o.mul)(n,(0,o.add)(s,g)),u=(0,o.sub)((0,o.sub)(b(e),b(t)),c);let d=t;(0,o.gt)(u,f(0,n))&&(d=t.concat({value:u,address:r}));const l=(0,o.sub)(b(e),b(d));return l?{inputs:e.map((e=>(0,i.convertToStandardUTXO)(e))),outputs:d,fee:l}:{fee:(0,o.mul)(n,s),inputs:e,outputs:d}}},980510:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.estimateFee=void 0;const a=r(n(162197)),i=n(318111),o=n(703818);t.estimateFee=async function({blockchainSymbol:e,testnet:t}){const n=[],r=[1,3,6,12];for(const s of r){const r=await(0,i.postJSON)({blockchainSymbol:e,endpoint:"/v1/estimateFee",body:{blocks:s,testnet:t}}),{body:c}=r,u=c&&(0,o.bnFromStringOrNumber)(c.fee,8);if(!u)throw new Error("unexpected response");const d=(0,o.bnDivCeil)(u,new a.default(1024));n.push(d)}return n}},278084:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.selectCoins=void 0;const a=r(n(162197)),i=n(326071),o=n(754795),s=n(453970),c=n(193979),u=n(464904),d=n(789068),l=n(456147),f=n(651674),m=n(848838);t.selectCoins=function({blockchainSymbol:e,utxos:t,toAddress:n,changeAddress:r,amount:p,feeRate:b,testnet:g,includeUTXOs:h,excludeUTXOs:y,hardcodedTotalFee:v}){(0,i.validateAddress)({blockchainSymbol:e,address:r,testnet:g}),(0,i.validateAddress)({blockchainSymbol:e,address:n,testnet:g});const T=t.filter((e=>!y.some((t=>t.hash===e.hash&&t.index===e.index)))).filter((e=>{if(h.some((t=>t.hash===e.hash&&t.index===e.index)))return!0;const t=(0,d.inputBytes)(e),n=(0,c.mul)(b,t),r=(0,d.uintOrNull)(e.value);return!(r&&(0,c.gt)(n,r))})),S=T.sort(((e,t)=>{const n=h.some((t=>t.hash===e.hash&&t.index===e.index)),r=h.some((e=>e.hash===t.hash&&e.index===t.index));return n&&r?t.value.gt(e.value)?1:-1:n?-1:r||t.value.gt(e.value)?1:-1})),w={address:n,value:p,type:(0,o.getAddressType)(e,n,g)},x="DOGE"===e?(0,f.calculateTxSizeForDOGE)(S,[w],!1):new a.default(0),O="DOGE"===e?(0,l.calculateTxFeeRateForDOGE)(x):b,_=(0,u.coinselect)(S,[w],new a.default(O),h,r,v);if(void 0===_.inputs||void 0===_.outputs){const e=(0,s.accumulative)(T,[w],O,r);throw void 0===e.inputs||void 0===e.outputs?m.CoinSelectError.unableToSelectCoins:m.CoinSelectError.excludedUTXOsPrecludeCoinSelection}return{inputs:_.inputs,outputs:_.outputs,fee:new a.default(_.fee)}}},957797:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sweepCoins=void 0;const a=r(n(162197)),i=n(754795),o=n(88560),s=n(193979),c=n(435211),u=n(789068),d=n(456147),l=n(651674),f=n(848838);t.sweepCoins=async function({blockchainSymbol:e,utxos:t,toAddress:n,feeRate:r,isTestnet:m,excludeUTXOs:p,hardcodedTotalFee:b}){const g=t.map((t=>({...t,addressType:(0,i.getAddressType)(e,t.address,m)}))).filter((e=>!p.some((t=>t.hash===e.hash&&t.index===e.index)))).filter((e=>{const t=(0,u.inputBytes)(e),n=(0,s.mul)(r,t),a=(0,u.uintOrNull)(e.value);return!(a&&(0,s.gt)(n,a))})),h=[{address:n,type:(0,i.getAddressType)(e,n,m),value:s.BN_ZERO}],y="DOGE"===e?(0,l.calculateTxSizeForDOGE)(g,h,!0):new a.default(0),v="DOGE"===e?(0,d.calculateTxFeeRateForDOGE)(y):r,T=(0,c.split)(g,h,v,n,b);if(void 0===T.inputs||void 0===T.outputs)throw f.CoinSelectError.unableToSelectCoins;return{inputs:T.inputs.map((e=>(0,o.convertToStandardUTXO)(e))),outputs:T.outputs,fee:new a.default(T.fee)}}},529829:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sweepCoins=t.selectCoins=t.estimateFee=void 0;var r=n(980510);Object.defineProperty(t,"estimateFee",{enumerable:!0,get:function(){return r.estimateFee}});var a=n(278084);Object.defineProperty(t,"selectCoins",{enumerable:!0,get:function(){return a.selectCoins}});var i=n(957797);Object.defineProperty(t,"sweepCoins",{enumerable:!0,get:function(){return i.sweepCoins}})},88560:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertToStandardUTXO=void 0,t.convertToStandardUTXO=function(e){const t={...e};return delete t.addressType,t}}}]);
//# sourceMappingURL=4061.js.map