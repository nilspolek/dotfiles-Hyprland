"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[4227],{661661:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricType=void 0,function(e){e.count="count",e.rate="rate",e.gauge="gauge",e.distribution="distribution",e.histogram="histogram"}(t.MetricType||(t.MetricType={}))},420378:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAssetPricesV3=t.RESOLUTIONS=t.RESOLUTION_DAY=t.getAssetsList=t.getAssetMetadata=t.getAssetsSearch=void 0;const s=r(362365),a=r(211774),c=r(49982),i=r(134813),o=`${a.CB_API_URL}/v2/assets`,n=`${a.CB_API_URL}/v3/coinbase.asset_metadata_service.v2.public.AssetMetadataPublicService`,u=`${a.CB_API_URL}/api/v3/coinbase.asset_stats_service.AssetStatsService`,d=`${a.CB_API_URL}/api/v3/coinbase.asset_stats_service.AssetStatsService/GetPriceChartForResolutions`;t.getAssetsSearch=async function(e,t){const r={query:e,base:t,country:"US",filter:"all",include_prices:"false",limit:"50",order:"asc",page:"1",resolution:"day",sort:"rank"};try{const{data:a}=await(0,c.getJSON)(`${o}/search`,r,{isThirdParty:!0});return(0,s.logPriceChartAssetLoadSucceeded)(e,t,r),a}catch(a){(0,s.logPriceChartAssetLoadFailed)(e,t,r,a)}return[]},t.getAssetMetadata=async function(e){const t={q:e};try{return await(0,c.getJSON)(`${n}/GetAssetV2`,t,{isThirdParty:!0})}catch(e){if(e instanceof i.HTTPError&&404===e.status)return;throw e}},t.getAssetsList=async function(e){const t={q:e};try{return await(0,c.getJSON)(`${u}/ListAssetStats`,t,{isThirdParty:!0})}catch(e){if(e instanceof i.HTTPError&&404===e.status)return;throw e}},t.RESOLUTION_DAY="RESOLUTION_DAY",t.RESOLUTIONS=["RESOLUTION_HOUR",t.RESOLUTION_DAY,"RESOLUTION_WEEK","RESOLUTION_MONTH","RESOLUTION_YEAR","RESOLUTION_ALL"],t.getAssetPricesV3=async function(e,r,a){try{if(!r)throw new Error(`invalid assetId provided: ${r}`);return function(e){const{priceCharts:[r],latestPrice:s,unitPriceScale:a}=e,{currency:c,priceChart:{uuid:i,symbol:o}}=r,n=o,u=i,d=function({priceCharts:e,latestPrice:r,currency:s,unitPriceScale:a}){const c=new Map,i=new Map;t.RESOLUTIONS.forEach((e=>{c.set(e,e.replace("RESOLUTION_","").toLowerCase())}));const o=e.reduce((function(e,t){const{resolution:r,priceChart:s}=t,{yAxisScalingFactor:a,percentChange:o,prices:n}=s,u=n.map((e=>[e.price,Number(e.timestamp)]));i.set(r,Number(o));const d={yAxisScalingFactor:a,percentChange:o,prices:u};return e[c.get(r)]=d,e}),{}),n={amount:r.price,currency:s,scale:a},u=[...i.entries()].reduce((function(e,[t,r]){return e[c.get(t)]=r,e}),{}),d={amount:n,percentChange:u,timestamp:r.timestamp},l=r.price;return{...o,latestPrice:d,latest:l}}({priceCharts:e.priceCharts,latestPrice:s,currency:c,unitPriceScale:a});return{base:n,baseId:u,currency:c,prices:d,unitPriceScale:a}}(await(0,c.getJSON)(`${d}`,{q:e},{isThirdParty:!0}))}catch(e){(0,s.logPriceChartPricesLoadFailed)(r??"",a,e)}}},362365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logPriceChartPricesLoadFailed=t.logPriceChartPricesLoadSucceeded=t.logPriceChartAssetMetaDataLoadFailed=t.logPriceChartAssetStatsLoadFailed=t.logPriceChartAssetLoadFailed=t.logPriceChartAssetMetaDataLoadSucceeded=t.logPriceChartAssetStatsLoadSucceeded=t.logPriceChartAssetLoadSucceeded=void 0;const s=r(160593),a=r(395545),c=r(661661);t.logPriceChartAssetLoadSucceeded=function(e,t,r){(0,s.logDataEvent)("price_chart.asset.load_succeeded",{loggingId:"e7348dd7-3d12-448a-93a7-feeab64dc35b",tokenSymbol:e,currencyCode:t,request:r})},t.logPriceChartAssetStatsLoadSucceeded=function(e,t){(0,s.logDataEvent)("price_chart.asset_stats_v3.load_succeeded",{loggingId:"6074c9dd-abb6-4ddc-a454-9c58bcf0e6c5",tokenSymbol:e,uuid:t})},t.logPriceChartAssetMetaDataLoadSucceeded=function(e,t){(0,s.logDataEvent)("price_chart.asset_metadata_v3.load_succeeded",{loggingId:"19d9c71a-83b8-443a-a1b8-7aa46132cd32",tokenSymbol:e,uuid:t})},t.logPriceChartAssetLoadFailed=function(e,t,r,a){(0,s.logDataEvent)("price_chart.asset.load_failed",{loggingId:"251bfaa4-4a7a-45c0-a5d3-85356e9ef793",tokenSymbol:e,currencyCode:t,request:r,error:String(a)})},t.logPriceChartAssetStatsLoadFailed=function(e,t,r){(0,s.logDataEvent)("price_chart.asset_stats_v3.load_failed",{loggingId:"2f4f42b8-c663-4e20-9192-5e1590a4be7a",tokenSymbol:e,uuid:t,error:String(r)})},t.logPriceChartAssetMetaDataLoadFailed=function(e,t,r){(0,s.logDataEvent)("price_chart.asset_metadata_v3.load_failed",{loggingId:"9f213d12-3dff-4b34-8404-1ea214674b88",tokenSymbol:e,uuid:t,error:String(r)})},t.logPriceChartPricesLoadSucceeded=function(e,t){(0,a.logMetric)({metricName:"price_chart.prices.load_succeeded",metricType:c.MetricType.count,value:1,tags:{baseAssetSymbol:e,currencyCode:t}})},t.logPriceChartPricesLoadFailed=function(e,t,r){(0,a.logMetric)({metricName:"price_chart.prices.load_failed",metricType:c.MetricType.count,value:1,tags:{baseAssetSymbol:e,currencyCode:t,error:String(r)}})}},234227:function(e,t,r){var s=r(348834).Buffer,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useAsset=void 0;const c=r(202784),i=r(946813),o=r(86296),n=r(602438),u=r(566992),d=r(362365),l=r(406693),_=a(r(545455)),S=r(420378),E="coinbase_asset",O=6e5;t.useAsset=function(e,t=void 0,r=!1){const{code:a}=(0,u.useActiveFiatCurrency)(),y=(0,c.useMemo)((()=>{let r={currency:a.rawValue,resolution:l.Resolution.RESOLUTION_DAY,sort_order:l.SortOrder.SORT_ORDER_ASCENDING,sort_field:l.SortField.SORT_FIELD_RANK};return r=t?{...r,uuids:[t]}:{...r,query:e},s.from(JSON.stringify(r),"utf-8").toString("base64")}),[e,a.rawValue,t]),g=(0,c.useMemo)((()=>t?s.from(JSON.stringify({uuid:t}),"utf-8").toString("base64"):s.from(JSON.stringify({symbol:e}),"utf-8").toString("base64")),[e,t]),R=(0,c.useMemo)((()=>[E,y]),[y]),L=(0,c.useMemo)((()=>[E,g]),[g]),{data:p,isFetched:f}=function({queryKeyAssetList:e,queryKeyAssetMetaData:t,assetListedQueryV2:r,assetMetaDataQueryV2:s,assetSymbol:a,uuid:u,suspense:l=!1}){const E=(0,i.useQueryClient)(),y={staleTime:O,suspense:l},g=(0,c.useCallback)((function(e){return u?e.assetUuid===u:e.assetSymbol.toUpperCase()===a.toUpperCase()}),[a,u]),R=(0,c.useCallback)((t=>{try{if(!t)return;const e=(t?.assetStats??[]).find(g);if(e){const t=e.price,r=e.marketCap;return{latest:t,market_cap:r,volume_24h:e.volume24h,listed:e.categories?.includes("listed")??!1}}}catch(t){return(0,o.cbReportError)(t),E.removeQueries(e),{latest:"",market_cap:"",volume_24h:"",listed:!1}}}),[g,E,e]),L=(0,c.useCallback)((e=>{try{if(!e)return;const t=e.asset,r=t.uuid,s=t.symbol,a=t.primaryColor,c=t.name,i=t.description,o=t.iconUrl,n=[];return t?.whitePaper&&n.push({title:"",link:t.whitePaper,type:"white_paper",icon_url:""}),t?.officialWebsite&&n.push({title:"",link:t.officialWebsite,type:"website",icon_url:""}),{id:r,symbol:s,color:a,name:c,description:i,image_url:o,resource_urls:n}}catch(e){return(0,o.cbReportError)(e),E.removeQueries(t),{id:"",symbol:"",color:"",name:"",description:"",image_url:"",resource_urls:[]}}}),[E,t]),p=(0,c.useCallback)((function(){(0,d.logPriceChartAssetStatsLoadSucceeded)(a,u)}),[a,u]),f=(0,c.useCallback)((function(e){(0,d.logPriceChartAssetStatsLoadFailed)(a,u,e);const t=(0,o.coerceError)(e,"useAsset"),r={assetSymbol:a,uuid:u??""};(0,o.cbReportError)({error:t,...r,context:"asset_http_error",severity:"error",isHandled:!1})}),[a,u]),h=(0,c.useCallback)((function(){(0,d.logPriceChartAssetMetaDataLoadSucceeded)(a,u)}),[a,u]),A=(0,c.useCallback)((function(e){(0,d.logPriceChartAssetMetaDataLoadFailed)(a,u,e);const t=(0,o.coerceError)(e,"useAsset"),r={assetSymbol:a,uuid:u??""};(0,o.cbReportError)({error:t,...r,context:"asset_http_error",severity:"error",isHandled:!1})}),[a,u]),C={queryKey:e,queryFn:async()=>(0,S.getAssetsList)(r),select:R,onSuccess:p,onError:f,...y},T={queryKey:t,queryFn:async()=>(0,S.getAssetMetadata)(s),select:L,onSuccess:h,onError:A,...y},{data:I,isFetched:b}=(0,n.useQuery)(C),{data:P,isFetched:N}=(0,n.useQuery)(T);return{data:!b||!N||(0,_.default)(I)&&(0,_.default)(P)?void 0:{...I,...P},isFetched:b&&N}}({queryKeyAssetList:R,queryKeyAssetMetaData:L,assetListedQueryV2:y,assetMetaDataQueryV2:g,assetSymbol:e,uuid:t,suspense:r});return{asset:p,isFetched:f}}},406693:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resolution=t.SortOrder=t.SortField=t.Currency=void 0,function(e){e.Usd="USD"}(t.Currency||(t.Currency={})),function(e){e.SORT_FIELD_UNSPECIFIED="SORT_FIELD_UNSPECIFIED",e.SORT_FIELD_MARKET_CAP="SORT_FIELD_MARKET_CAP",e.SORT_FIELD_ASSET_NAME="SORT_FIELD_ASSET_NAME",e.SORT_FIELD_PERCENT_CHANGE="SORT_FIELD_PERCENT_CHANGE",e.SORT_FIELD_RANK="SORT_FIELD_RANK",e.SORT_FIELD_PRICE="SORT_FIELD_PRICE",e.SORT_FIELD_VOLUME="SORT_FIELD_VOLUME"}(t.SortField||(t.SortField={})),function(e){e.SORT_ORDER_UNSPECIFIED="SORT_ORDER_UNSPECIFIED",e.SORT_ORDER_ASCENDING="SORT_ORDER_ASCENDING",e.SORT_ORDER_DESCENDING="SORT_ORDER_DESCENDING"}(t.SortOrder||(t.SortOrder={})),function(e){e.RESOLUTION_UNSPECIFIED="RESOLUTION_UNSPECIFIED",e.RESOLUTION_HOUR="RESOLUTION_HOUR",e.RESOLUTION_DAY="RESOLUTION_DAY",e.RESOLUTION_WEEK="RESOLUTION_WEEK",e.RESOLUTION_MONTH="RESOLUTION_MONTH",e.RESOLUTION_YEAR="RESOLUTION_YEAR",e.RESOLUTION_ALL="RESOLUTION_ALL"}(t.Resolution||(t.Resolution={}))}}]);
//# sourceMappingURL=4227.js.map