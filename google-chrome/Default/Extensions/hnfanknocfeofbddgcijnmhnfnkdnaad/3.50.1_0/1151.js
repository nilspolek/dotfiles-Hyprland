"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[1151],{116414:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var s,n,a=Object.defineProperty,o=Object.defineProperties,i=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,l=(e,t,s)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,p=(e,t)=>a(e,"name",{value:t,configurable:!0});(n=s||(s=t.MessageCodes={})).LaunchEmbedded="launch_embedded",n.AppReady="app_ready",n.AppParams="app_params",n.SigninSuccess="signin_success",n.Success="success",n.Exit="exit",n.Event="event",n.PixelReady="pixel_ready",n.OnAppParamsNonce="on_app_params_nonce";var h=p(((e,{onMessage:t,shouldUnsubscribe:s=!0,allowedOrigin:n,onValidateOrigin:a=p((()=>Promise.resolve(!0)),"onValidateOrigin")})=>{const o=p((i=>{const{eventName:r,data:d}=v(i.data),c=!n||i.origin===n;r===e&&(async()=>{c&&await a(i.origin)&&(t(d),s&&window.removeEventListener("message",o))})()}),"onMessage");return window.addEventListener("message",o),()=>{window.removeEventListener("message",o)}}),"onBroadcastedPostMessage"),u=p((e=>e!==window?e:g(e)?{postMessage:t=>e.ReactNativeWebView.postMessage(t)}:e.opener?e.opener:e.parent!==e.self?e.parent:void 0),"getSdkTarget"),g=p((e=>{var t;try{return void 0!==(null==(t=e.ReactNativeWebView)?void 0:t.postMessage)}catch(e){return!1}}),"isMobileSdkTarget"),m=p(((e,t,{allowedOrigin:s="*",data:n}={})=>{const a=b(t,n);e.postMessage(a,s)}),"broadcastPostMessage"),v=p((e=>{try{return JSON.parse(e)}catch(t){return{eventName:e}}}),"parsePostMessage"),b=p(((e,t)=>t?JSON.stringify({eventName:e,data:t}):e),"formatPostMessage");t.__spreadValues=(e,t)=>{for(var s in t||(t={}))d.call(t,s)&&l(e,s,t[s]);if(r)for(var s of r(t))c.call(t,s)&&l(e,s,t[s]);return e},t.__spreadProps=(e,t)=>o(e,i(t)),t.__name=p,t.__objRest=(e,t)=>{var s={};for(var n in e)d.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&r)for(var n of r(e))t.indexOf(n)<0&&c.call(e,n)&&(s[n]=e[n]);return s},t.MessageCodes=s,t.onBroadcastedPostMessage=h,t.getSdkTarget=u,t.broadcastPostMessage=m},331151:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=s(116414),a="https://pay.coinbase.com";function o(e){const t=e.reduce(((e,{address:t,blockchains:s,assets:n})=>(e[t]=(e[t]||[]).concat(s||[]).concat(n||[]),e)),{});return Object.entries(t).forEach((([e,s])=>{t[e]=[...new Set(s)]})),t}n.__name.call(void 0,o,"parseDestinationWallets");var i=n.__name.call(void 0,(({appId:e,destinationWallets:t,paymentMethodsSupported:s=[],host:n=a})=>{const i=new URL(n);return i.pathname="/buy/select-asset",i.searchParams.append("appId",e),i.searchParams.append("destinationWallets",JSON.stringify(o(t))),i.searchParams.append("paymentMethodsSupported",JSON.stringify(s)),i.toString()}),"generateOnrampURL"),r=n.__name.call(void 0,((...e)=>{const t=i(...e);chrome.tabs.create({url:t.toString()})}),"open"),d="cbpay-embedded-onramp",c=n.__name.call(void 0,(({url:e,width:t="100%",height:s="100%",position:n="fixed",top:a="0px"})=>{const o=document.createElement("iframe");return o.style.border="unset",o.style.borderWidth="0",o.style.width=t.toString(),o.style.height=s.toString(),o.style.position=n,o.style.top=a,o.id=d,o.src=e,o}),"createEmbeddedContent"),l="coinbase-sdk-connect",p={width:460,height:730},h={width:430,height:600},u=class{constructor({host:e=a,appId:t,appParams:s,onReady:o}){this.nonce="",this.eventStreamListeners={},this.unsubs=[],this.isReady=!1,this.isLoggedIn=!1,this.openExperience=e=>{if(!this.isReady)return void this.onMessage("on_app_params_nonce",{onMessage:()=>{this.openExperience(e)}});const{path:t,experienceLoggedIn:s,experienceLoggedOut:a,embeddedContentStyles:o,onExit:i,onSuccess:r,onEvent:d}=e,l=new URL(`${this.host}${t}`);l.searchParams.append("appId",this.appId),l.searchParams.append("type","secure_standalone");const u=this.isLoggedIn?s:a||s;this.setupExperienceListeners({onExit:i,onSuccess:r,onEvent:d}),this.sendAppParams(this.appParams,(()=>{var e,t,s,a;l.searchParams.append("nonce",this.nonce);const i=l.toString();if(this.nonce="","embedded"===u){const e=n.__name.call(void 0,(()=>{var e;const t=c(n.__spreadValues.call(void 0,{url:i},o));(null==o?void 0:o.target)?null==(e=document.querySelector(null==o?void 0:o.target))||e.replaceChildren(t):document.body.appendChild(t)}),"openEmbeddedExperience");this.isLoggedIn?e():this.startDirectSignin(e)}else"popup"===u&&(null==(t=null==(e=window.chrome)?void 0:e.windows)?void 0:t.create)?window.chrome.windows.create({url:i,setSelfAsOpener:!0,type:"popup",focused:!0,width:p.width,height:p.height,left:window.screenLeft-p.width-10,top:window.screenTop},(e=>{this.addEventStreamListener("open",(()=>{(null==e?void 0:e.id)&&chrome.windows.update(e.id,{width:h.width,height:h.height,left:window.screenLeft-h.width-10,top:window.screenTop})}))})):"new_tab"===u&&(null==(a=null==(s=window.chrome)?void 0:s.tabs)?void 0:a.create)?window.chrome.tabs.create({url:i}):m(i,u)}))},this.endExperience=()=>{var e;null==(e=document.getElementById(d))||e.remove()},this.destroy=()=>{var e;null==(e=document.getElementById(l))||e.remove(),this.unsubs.forEach((e=>e()))},this.setupListeners=()=>{this.onMessage("pixel_ready",{shouldUnsubscribe:!1,onMessage:e=>{this.isLoggedIn=!!(null==e?void 0:e.isLoggedIn),this.sendAppParams(this.appParams)}}),this.onMessage("on_app_params_nonce",{shouldUnsubscribe:!0,onMessage:()=>{var e;this.isReady=!0,null==(e=this.onReadyCallback)||e.call(this)}}),this.onMessage("on_app_params_nonce",{shouldUnsubscribe:!1,onMessage:e=>{this.nonce=(null==e?void 0:e.nonce)||""}})},this.embedPixel=()=>{var e;null==(e=document.getElementById(l))||e.remove();const t=g({host:this.host,appId:this.appId});t.onerror=()=>{var e;null==(e=this.onReadyCallback)||e.call(this,new Error("Failed to initialize app"))},this.pixelIframe=t,document.body.appendChild(t)},this.sendAppParams=(e,t)=>{this.nonce?null==t||t():this.pixelIframe&&(n.broadcastPostMessage.call(void 0,this.pixelIframe.contentWindow,"app_params",{data:e}),this.onMessage("on_app_params_nonce",{onMessage:()=>null==t?void 0:t()}))},this.setupExperienceListeners=({onSuccess:e,onExit:t,onEvent:s})=>{s&&this.onMessage("event",{shouldUnsubscribe:!1,onMessage:n=>{var a;const o=n;null==(a=this.eventStreamListeners[o.eventName])||a.forEach((e=>null==e?void 0:e())),"success"===o.eventName&&(null==e||e()),"exit"===o.eventName&&(null==t||t(o.error)),s(n)}})},this.startDirectSignin=e=>{const t=new URLSearchParams;t.set("appId",this.appId),t.set("type","direct");const s=m(`${this.host}/signin?${t.toString()}`,"popup");this.onMessage("signin_success",{onMessage:()=>{null==s||s.close(),e()}})},this.addEventStreamListener=(e,t)=>{var s;this.eventStreamListeners[e]?null==(s=this.eventStreamListeners[e])||s.push(t):this.eventStreamListeners[e]=[t]},this.onMessage=(...e)=>{this.unsubs.push(n.onBroadcastedPostMessage.call(void 0,e[0],n.__spreadValues.call(void 0,{allowedOrigin:this.host},e[1])))},this.host=e,this.appId=t,this.appParams=s,this.onReadyCallback=o,this.setupListeners(),this.embedPixel()}};function g({host:e,appId:t}){const s=document.createElement("iframe");s.style.border="unset",s.style.borderWidth="0",s.style.width="0",s.style.height="0",s.style.height="0",s.id=l;const n=new URL(`${e}/embed`);return n.searchParams.append("appId",t),s.src=n.toString(),s}function m(e,t){return window.open(e,"Coinbase","popup"===t?`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, height=${p.height},width=${p.width}`:void 0)}n.__name.call(void 0,u,"CoinbasePixel"),n.__name.call(void 0,g,"createPixel"),n.__name.call(void 0,m,"openWindow");var v,b,_,w,y={buy:"/buy",checkout:"/checkout"},P=class{constructor(e){this.open=()=>{const{widget:e,experienceLoggedIn:t,experienceLoggedOut:s,embeddedContentStyles:n,onExit:a,onSuccess:o,onEvent:i,closeOnSuccess:r,closeOnExit:d}=this.options;this.pixel.openExperience({path:y[e],experienceLoggedIn:t,experienceLoggedOut:s,embeddedContentStyles:n,onExit:()=>{null==a||a(),d&&this.pixel.endExperience()},onSuccess:()=>{null==o||o(),r&&this.pixel.endExperience()},onEvent:i})},this.destroy=()=>{this.pixel.destroy()};const t=n.__spreadValues.call(void 0,{widget:e.widget},e.appParams);if(this.options=e,this.pixel=new u({host:e.host,appId:e.appId,appParams:t,onReady:e.onReady}),e.target){const t=document.querySelector(e.target);t&&t.addEventListener("click",this.open)}}};n.__name.call(void 0,P,"CBPayInstance"),(b=v||(v={}))[b.Buy=0]="Buy",b[b.Sell=1]="Sell",(w=_||(_={}))[w.EIP712=2]="EIP712",w[w.ETHSIGN=3]="ETHSIGN",w[w.PRESIGNED=4]="PRESIGNED";var x=n.__name.call(void 0,(e=>{var t=e,{experienceLoggedIn:s="embedded",widgetParameters:a}=t,o=n.__objRest.call(void 0,t,["experienceLoggedIn","widgetParameters"]);return new P(n.__spreadProps.call(void 0,n.__spreadValues.call(void 0,{},o),{widget:"checkout",experienceLoggedIn:s,appParams:a}))}),"initCheckout"),S=n.__name.call(void 0,(e=>{var t=e,{experienceLoggedIn:s="embedded",widgetParameters:a}=t,o=n.__objRest.call(void 0,t,["experienceLoggedIn","widgetParameters"]);return new P(n.__spreadProps.call(void 0,n.__spreadValues.call(void 0,{},o),{widget:"buy",experienceLoggedIn:s,appParams:a}))}),"initOnramp"),E=n.__name.call(void 0,(({host:e,appId:t,experienceLoggedin:s="embedded",experienceLoggedout:n="embedded",type:a="direct",standaloneTarget:o,width:i="262px",height:r="48px"})=>{const d=document.createElement("iframe");d.style.border="unset",d.style.borderWidth="0",d.style.width=i.toString(),d.style.height=r.toString();const c=new URL(`${e}/embed/button`);return c.searchParams.append("appId",t),c.searchParams.append("type",a),c.searchParams.append("experience_loggedin",s),c.searchParams.append("experience_loggedout",n),o&&c.searchParams.append("target",o),d.src=c.toString(),d}),"createCoinbaseButton"),L=n.__name.call(void 0,(({appId:e,destinationWallets:t,target:s=".coinbase-login-button",host:n=a,onExit:o,onSuccess:i,closeOnExit:r,closeOnSuccess:d,iframeStyles:c,experienceLoggedin:l="embedded"})=>{var p;const h=E({appId:e,host:n,experienceLoggedout:"popup",experienceLoggedin:l,type:"secure_standalone"});f(h,n,t),I(e,n,t,c),o&&M(o,"exit",n,r),i&&M(i,"success",n,d),null==(p=document.querySelector(s))||p.replaceChildren(h)}),"initOnrampButton"),f=n.__name.call(void 0,((e,t,s)=>{n.onBroadcastedPostMessage.call(void 0,"app_ready",{allowedOrigin:t,shouldUnsubscribe:!1,onMessage:()=>{n.broadcastPostMessage.call(void 0,e.contentWindow,"app_params",{allowedOrigin:t,data:{widget:"buy",destinationWallets:s}})}})}),"setupAppReadyListeners"),I=n.__name.call(void 0,((e,t,s,a)=>{n.onBroadcastedPostMessage.call(void 0,"launch_embedded",{allowedOrigin:t,shouldUnsubscribe:!1,onMessage:()=>{const o=new URL(`${t}/buy/`);o.searchParams.append("appId",e),o.searchParams.append("type","secure_standalone");const i=c(n.__spreadValues.call(void 0,{url:o.toString()},a));f(i,t,s),document.body.appendChild(i)}})}),"setupLaunchEmbeddedListeners"),M=n.__name.call(void 0,((e,t,s,a=!1)=>{n.onBroadcastedPostMessage.call(void 0,t,{allowedOrigin:s,shouldUnsubscribe:!1,onMessage:()=>{if(e(),a){const e=document.getElementById(d);null==e||e.remove()}}})}),"setupCallbackListener"),O={open:r};t.default=O,t.generateOnrampURL=i,t.initCheckout=x,t.initOnramp=S,t.initOnrampButton=L,t.openBuyStandalone=r}}]);
//# sourceMappingURL=1151.js.map