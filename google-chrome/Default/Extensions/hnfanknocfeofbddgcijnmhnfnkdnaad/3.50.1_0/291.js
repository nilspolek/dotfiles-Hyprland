"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[291],{850291:(e,t,a)=>{a.r(t),a.d(t,{WatchlistDiscovery:()=>k});var s,o=a(202784),i=a(239398),n=a(783112),r=a(107267),c=a(849495),l=a(632810),d=a(974421),u=a(976974),h=a(352871),v=a(790424),p=a(48972),y=a(661641),m=a(268708),f=a(931192),b=a(781462),g=a(552322);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);var W,E,C="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},x=(0,i.defineMessages)({title:{id:"R5lQBf",defaultMessage:[{type:0,value:"Create a watchlist"}]},description:{id:"6fWljh",defaultMessage:[{type:0,value:"Add items to your watchlist and get alerted about important price movements"}]}}),k=(0,o.memo)(C((function(){var e,t=(0,n.Z)().formatMessage,a=(0,r.useHistory)().goBack,s=(0,d.useTopCoins)(),i=s.data,W=s.isLoading,E=null===(e=(0,l.usePrimaryReceiveWallets)().get("ETH"))||void 0===e?void 0:e.primaryAddress;(0,m.V)(u.PERF_MARKS.watchlist,u.WATCHLIST_MARKS.navigate_to_watchlist_discovery,{type:"end"});var C=(0,c.useWatchlistDiscoveryButtonEvent)(),k=(0,o.useCallback)((function(){C(),a()}),[C,a]);if(!E)throw new Error("WatchlistDiscovery: missing active ETH wallet");var w=(0,o.useMemo)((function(){return W?(0,g.jsx)(b.H,{description:t(x.description),title:t(x.title),isDiscovery:!0}):(0,g.jsxs)(p.VStack,{spacingHorizontal:3,gap:1,testID:"watchlist-discovery-list",spacingBottom:2,children:[(0,g.jsxs)(p.VStack,{spacingBottom:2,gap:1,children:[(0,g.jsx)(y.TextTitle1,{overflow:"wrap",as:"h1",children:t(x.title)}),(0,g.jsx)(y.TextBody,{as:"p",color:"foregroundMuted",children:t(x.description)})]}),null==i?void 0:i.map((function(e,t){return(0,g.jsx)(f.q,{address:E,index:t,item:e})}))]})}),[i,t,W,E]);return(0,g.jsx)(v.lL,{height:"100%",header:(0,g.jsx)(h.l2,{variant:"secondary",handleBack:k,hasPageTitle:!0,isSticky:!0}),children:w})}),"useIntl{{ formatMessage }}\nuseHistory{{ goBack }}\nuseTopCoins{{ data, isLoading }}\nusePrimaryReceiveWallets{}\nusePerfMarkOnMount{}\nuseWatchlistDiscoveryButtonEvent{backEvent}\nuseCallback{handleGoBack}\nuseMemo{content}",(function(){return[n.Z,r.useHistory,d.useTopCoins,l.usePrimaryReceiveWallets,m.V,c.useWatchlistDiscoveryButtonEvent]})));(W="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(W.register(x,"messages","/workspaces/apps/extension/src/screens/Watchlist/WatchlistDiscovery.tsx"),W.register(k,"WatchlistDiscovery","/workspaces/apps/extension/src/screens/Watchlist/WatchlistDiscovery.tsx")),(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&E(e)},931192:(e,t,a)=>{a.d(t,{q:()=>H});var s,o=a(202784),i=a(107267),n=a(849495),r=a(86296),c=a(93228),l=a(656695),d=a(422997),u=a(889175),h=a(230438),v=a(572810),p=a(698570),y=a(5437),m=a(160756),f=a(599050),b=a(960723),g=a(853052),W=a(48972),E=a(252163),C=a(661641),x=a(682513),k=a(552322);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);var w,A,T="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},H=(0,o.memo)(T((function(e){var t,a=e.address,s=e.index,w=e.item,A=(0,i.useHistory)(),T=(0,p.V)({contractAddress:w.address,symbol:w.currencyCode,uuid:w.uuid,walletAddress:a}),H=T.isWatchable,L=T.isWatching,_=T.optimisticUpdate,M=T.resetUpdate,G=(0,u.q)({address:w.address,blockchain:w.blockchain,chainId:w.chainId,decimals:w.decimals,name:w.name,symbol:w.currencyCode,uuid:w.uuid}),I=(0,o.useMemo)((function(){return{chainName:w.blockchain,entityName:w.name,entityType:n.EntityTypeEnum.ASSET,rankIndex:s}}),[s,w.blockchain,w.name]),S=(0,n.useClickWatchlistDiscoveryCardEvent)(I),D=(0,n.useViewWatchlistDiscoveryCardEvent)(I);(0,l.useOnMount)(D);var j=(0,n.useWatchlistButtonEvent)({entityName:w.name,chainName:w.blockchain}),P=(0,h.useActiveWalletGroupId)(),U=(0,d.useGetExploreAssetWallet)(P)(G.id),B=(0,c.Ct)(w.currencyCode,w.uuid,!0),O=B.formattedPercent,R=B.percentColor,V=B.percentArrow,Y=(0,o.useCallback)((function(){var e;S(),A.push("/portfolio/crypto/".concat(encodeURIComponent(null!==(e=null==U?void 0:U.id)&&void 0!==e?e:G.id),"/").concat(x.FU.Explore))}),[null==U?void 0:U.id,S,A,G.id]),N=(0,m.E)(G),Q=(0,o.useMemo)((function(){return{currencyCode:G.symbol,iconUrl:G.imageUrl,showIconTooltipOverride:!1}}),[G.imageUrl,G.symbol]),F=(0,o.useCallback)((function(e){M(),(0,r.cbReportError)({context:"component_error",error:new Error("WatchlistDiscoveryCell: ".concat(e)),severity:"error",isHandled:!1,isUserVisible:!0})}),[M]),K=(0,o.useCallback)((function(e){var t=e.isWatchingUpdate;j({componentName:t?"add":"remove"})}),[j]),q=(0,v.D)({blockchain:w.blockchain,chainId:w.chainId,contractAddress:w.address,handleError:F,handleSuccess:K,symbol:w.currencyCode,type:"OBJECT_TYPE_ASSET",uuid:w.uuid,walletAddress:a}),J=q.addToWatchlist,z=q.isAdding,Z=(0,y.r)({contractAddress:w.address,handleError:F,handleSuccess:K,symbol:w.currencyCode,type:"OBJECT_TYPE_ASSET",walletAddress:a}),X=Z.removeFromWatchlist,$=Z.isRemoving,ee=(0,o.useCallback)((function(e){e.stopPropagation(),_(),L?X():J()}),[J,L,_,X]),te=(0,n.useUnwatchableAssetEvent)({chainName:w.blockchain,contractAddress:null!==(t=w.address)&&void 0!==t?t:"",entityName:w.name,componentName:"watchlist_discovery"});return(0,o.useEffect)((function(){H||te()}),[te,H]),H?(0,k.jsx)(E.Pressable,{borderRadius:"roundedLarge",backgroundColor:"backgroundAlternate",onPress:Y,children:(0,k.jsx)(g.ListCell,{media:(0,k.jsx)(f.Y,{asset:Q,width:32,height:32}),title:(0,k.jsx)(C.TextHeadline,{as:"h1",noWrap:!0,overflow:"truncate",children:w.name}),description:(0,k.jsx)(C.TextLabel2,{as:"p",color:"foregroundMuted",children:w.currencyCode}),detail:(0,k.jsxs)(W.HStack,{justifyContent:"flex-end",gap:1,children:[(0,k.jsxs)(W.VStack,{children:[(0,k.jsx)(C.TextLabel2,{as:"p",align:"end",children:N}),(0,k.jsx)(C.TextBody,{as:"p",color:R,align:"end",children:"".concat(V," ").concat(O)})]}),(0,k.jsx)(b.IconButton,{name:L?"starActive":"starInactive",onPress:ee,disabled:z||$,variant:L?"primary":"secondary",testID:"watchlist-discovery-toggle",transparent:!0,compact:!0})]}),testID:"watchlist-discovery-cell",compact:!0})}):null}),"useHistory{history}\nuseAssetWatchlistState{{ isWatchable, isWatching, optimisticUpdate, resetUpdate }}\nuseWatchlistItem{watchedAsset}\nuseMemo{eventData}\nuseClickWatchlistDiscoveryCardEvent{cellClickEvent}\nuseViewWatchlistDiscoveryCardEvent{viewEvent}\nuseOnMount{}\nuseWatchlistButtonEvent{watchEvent}\nuseActiveWalletGroupId{activeWalletGroupId}\nuseGetExploreAssetWallet{getExploreAssetWallet}\nuseGetPriceDetail{{ formattedPercent, percentColor, percentArrow }}\nuseCallback{handleNavigation}\nuseWatchedAssetPrice{formattedAmount}\nuseMemo{assetLike}\nuseCallback{handleError}\nuseCallback{handleSuccess}\nuseAddToWatchlist{{ addToWatchlist, isAdding }}\nuseRemoveFromWatchlist{{ removeFromWatchlist, isRemoving }}\nuseCallback{handleWatchlistUpdate}\nuseUnwatchableAssetEvent{unwatchableAssetEvent}\nuseEffect{}",(function(){return[i.useHistory,p.V,u.q,n.useClickWatchlistDiscoveryCardEvent,n.useViewWatchlistDiscoveryCardEvent,l.useOnMount,n.useWatchlistButtonEvent,h.useActiveWalletGroupId,d.useGetExploreAssetWallet,c.Ct,m.E,v.D,y.r,n.useUnwatchableAssetEvent]})));(w="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&w.register(H,"WatchlistDiscoveryCell","/workspaces/apps/extension/src/screens/Watchlist/components/WatchlistDiscoveryCell.tsx"),(A="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&A(e)},781462:(e,t,a)=>{a.d(t,{H:()=>u});var s,o=a(202784),i=a(544562),n=a(48972),r=a(661641),c=a(552322);e=a.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var l,d,u=(0,o.memo)((function(e){var t=e.cta,a=void 0===t?void 0:t,s=e.description,l=void 0===s?void 0:s,d=e.isDiscovery,u=void 0!==d&&d,h=e.title;return(0,c.jsxs)(n.Box,{flexBasis:1,flexGrow:1,flexDirection:"column",testID:"watchlist-".concat(u?"discovery-":"","loading"),children:[(0,c.jsxs)(n.VStack,{spacingHorizontal:3,spacingVertical:u?0:2,spacingBottom:u?3:0,gap:1,children:[(0,c.jsx)(r.TextTitle1,{as:"h1",children:h}),!!l&&(0,c.jsx)(r.TextBody,{as:"p",color:"foregroundMuted",children:l})]}),Array(4).fill((0,c.jsx)(i.ListCellFallback,{title:!0,description:!0,detail:!0,subdetail:!0,media:"asset",compact:!0})).map((function(e,t){return(0,c.jsx)(o.Fragment,{children:e},"watchlist-".concat(u?"discovery-":"","fallback-").concat(t))})),a]})}));(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&l.register(u,"WatchlistLoading","/workspaces/apps/extension/src/screens/Watchlist/components/WatchlistLoading.tsx"),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(e)},974421:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useTopCoins=t.TOP_COINS_QUERY_KEY=void 0;const s=a(202784),o=a(602438),i=a(442893),n=a(49982);t.TOP_COINS_QUERY_KEY="explore/tokens/marketCap",t.useTopCoins=function(){const e=(0,i.useIsExploreMultichainEligible)(),{data:a,isLoading:r,refetch:c}=(0,o.useQuery)([t.TOP_COINS_QUERY_KEY],(async()=>async function(e){const a={multichainEnabled:e?"1":"0"},{result:s}=await(0,n.getJSON)(t.TOP_COINS_QUERY_KEY,a);return s.data}(e)));return(0,s.useMemo)((()=>({data:a,isLoading:r,refetch:c})),[a,r,c])}},442893:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useIsExploreMultichainEligible=void 0;const s=a(214390),o=a(245556);t.useIsExploreMultichainEligible=function(){return!(0,s.useOverridableKillSwitch)((0,o.getKillSwitchForPlatform)("kill_explore_multichain"))}},572810:(e,t,a)=>{t.D=void 0;const s=a(202784),o=a(946813),i=a(69401),n=a(774710);t.D=function({blockchain:e,chainId:t,contractAddress:a,symbol:r,type:c,uuid:l,walletAddress:d,handleSuccess:u,handleError:h}){const{mutateAsync:v,isLoading:p}=(0,o.useMutation)({mutationFn:async()=>(0,n.addToWatchlist)({blockchain:e,chainId:t,contractAddress:a,symbol:r,type:c,uuid:l,walletAddress:d})}),y=(0,s.useCallback)((async function(){try{await v(),i.queryClient.invalidateQueries([n.GET_WATCHLIST_QUERY_KEY,d]),i.queryClient.invalidateQueries([d,r]),u({isWatchingUpdate:!0})}catch(e){h(e)}}),[v,d,r,u,h]);return(0,s.useMemo)((()=>({addToWatchlist:y,isAdding:p})),[p,y])}},698570:(e,t,a)=>{t.V=void 0;const s=a(202784),o=a(357297);t.V=function(e){const{isWatchable:t,isWatching:a}=(0,o.useIsWatching)(e);if(void 0===a)throw new Error("useAssetWatchlistState: didn't receive isWatching data");const[i,n]=(0,s.useState)(a);(0,s.useEffect)((function(){n(a)}),[a]);const r=(0,s.useCallback)((function(){n((e=>!e))}),[]);return(0,s.useMemo)((()=>({isWatching:i,isWatchable:t,optimisticUpdate:r,resetUpdate:r})),[t,i,r])}},357297:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useIsWatching=void 0;const s=a(202784),o=a(602438),i=a(774710);t.useIsWatching=function({contractAddress:e,symbol:t,uuid:a,walletAddress:n}){const{data:r}=(0,o.useQuery)([n,t],(async()=>(0,i.fetchIsWatching)({contractAddress:e,symbol:t,uuid:a,walletAddress:n})),{notifyOnChangeProps:["data"],suspense:!0});return(0,s.useMemo)((()=>({isWatching:r?.isWatching,isWatchable:r?.isWatchable})),[r])}},5437:(e,t,a)=>{t.r=void 0;const s=a(202784),o=a(946813),i=a(69401),n=a(774710);t.r=function({contractAddress:e,symbol:t,type:a,walletAddress:r,handleSuccess:c,handleError:l}){const{mutateAsync:d,isLoading:u}=(0,o.useMutation)({mutationFn:async()=>(0,n.removeFromWatchlist)({contractAddress:e,symbol:t,type:a,walletAddress:r})}),h=(0,s.useCallback)((async function(){try{await d(),i.queryClient.invalidateQueries([n.GET_WATCHLIST_QUERY_KEY,r]),i.queryClient.invalidateQueries([r,t]),c({isWatchingUpdate:!1})}catch(e){l(e)}}),[d,r,t,c,l]);return(0,s.useMemo)((()=>({removeFromWatchlist:h,isRemoving:u})),[u,h])}}}]);
//# sourceMappingURL=291.js.map